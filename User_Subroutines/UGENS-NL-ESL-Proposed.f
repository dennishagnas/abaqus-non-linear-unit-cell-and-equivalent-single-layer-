C ---------------------------------------------------------------------
C 
C Abaqus UGENS script for defining non-linear ESL element stiffness
C
C ---------------------------------------------------------------------
	  !DEC$ ATTRIBUTES ALIAS:"ugens"::UGENS
	  subroutine UGENS(ddndde,force,statev,sse,spd,pnewdt,stran,dstran,
     1 tss,time,dtime,temp,dtemp,predef,dpred,cename,ndi,nshr,nsecv,
     2 nstatv,props,jprops,nprops,njprop,coords,celent,thick,dfgrd,
     3 curv,basis,noel,npt,kstep,kinc,kit,linper )
C
      include 'aba_param.inc'
C
      character*80 cename
      dimension force(nsecv),statev(nstatv),ddndde(nsecv,nsecv),
     1 stran(nsecv),dstran(nsecv),predef(*),dpred(*),
     2 props(*),jprops(*),coords(3),time(2),dfgrd(3,3),
     3 curv(2,2),basis(3,3),tss(*)
	  real*8, allocatable :: A11(:),A12(:),A21(:),A22(:)
      real*8, allocatable :: A33(:),B11(:),B12(:),B21(:)
      real*8, allocatable :: B22(:),B33(:),C11(:),C12(:)
      real*8, allocatable :: C21(:),C22(:),C33(:),D11(:)
      real*8, allocatable :: D12(:),D21(:),D22(:),D33(:)
      real*8, allocatable :: e1(:),e2(:)
      real*8, allocatable :: STIF(:,:,:),e(:,:,:)
      integer i,ii,j,jj,kk,m,k,n,p,curr_ID,next_ID,ij,idx1,idx2
      REAL :: stranCurrent, stranNext
      LOGICAL :: found
      double precision e_int1,e_int2
      parameter (zero=0.0d0,half=0.5d0)
      allocate(A11(121),A12(121),A21(121),A22(121),A33(121),B11(121))
      allocate(B12(121),B21(121),B22(121),B33(121),C11(121),C12(121))
	  allocate(C21(121),C22(121),C33(121),D11(121),D12(121),D21(121))
	  allocate(D22(121),D33(121))
	  allocate(e1(121),e2(121),STIF(121,6,6),e(121,6,6))
C
C ------------------ PRE-DEFINED STRAIN INTERVALS ---------------------
C
      e1=(/-1.05e-02,-1.00e-02,-9.78e-03,-8.79e-03,-7.89e-03,-7.09e-03, 
     + -6.36e-03,-5.72e-03,-5.14e-03,-4.61e-03,-4.14e-03,-3.72e-03,
     + -3.34e-03,-3.00e-03,-2.69e-03,-2.41e-03,-2.17e-03,-1.95e-03,
     + -1.75e-03,-1.57e-03,-1.41e-03,-1.26e-03,-1.13e-03,-1.02e-03,
     + -9.12e-04,-8.18e-04,-7.33e-04,-6.57e-04,-5.89e-04,-5.28e-04,
     + -4.72e-04,-4.23e-04,-3.78e-04,-3.38e-04,-3.02e-04,-2.69e-04,
     + -2.41e-04,-2.14e-04,-1.91e-04,-1.70e-04,-1.51e-04,-1.34e-04,
     + -1.04e-04,-9.25e-05,-8.14e-05,-7.14e-05,-6.25e-05,-5.44e-05,
     + -4.72e-05,-4.07e-05,-3.49e-05,-2.96e-05,-2.49e-05,-2.07e-05,
     + -1.69e-05,-1.35e-05,-1.04e-05,-7.70e-06,-5.22e-06,-3.00e-06,
     + -1.00e-06,0.00e+00,1.00e-06,3.00e-06,5.22e-06,7.70e-06,
     + 1.04e-05,1.35e-05,1.69e-05,2.07e-05,2.49e-05,2.96e-05,
     + 3.49e-05,4.07e-05,4.72e-05,5.44e-05,6.25e-05,7.14e-05,
     + 8.14e-05,9.25e-05,1.04e-04,1.34e-04,1.51e-04,1.70e-04,
     + 1.91e-04,2.14e-04,2.41e-04,2.69e-04,3.02e-04,3.38e-04,
     + 3.78e-04,4.23e-04,4.72e-04,5.28e-04,5.89e-04,6.57e-04,
     + 7.33e-04,8.18e-04,9.12e-04,1.02e-03,1.13e-03,1.26e-03,
     + 1.41e-03,1.57e-03,1.75e-03,1.95e-03,2.17e-03,2.41e-03,
     + 2.69e-03,3.00e-03,3.34e-03,3.72e-03,4.14e-03,4.61e-03,
     + 5.14e-03,5.72e-03,6.36e-03,7.09e-03,7.89e-03,8.79e-03,
     + 1.00e-02/)
	  e2=(/-5.10e-01,-5.00e-01,-4.97e-01,-4.41e-01,-3.90e-01,-3.46e-01,
     + -3.06e-01,-2.71e-01,-2.40e-01,-2.13e-01,-1.88e-01,-1.67e-01,
     + -1.47e-01,-1.31e-01,-1.15e-01,-1.03e-01,-9.07e-02,-8.03e-02,
     + -7.11e-02,-6.30e-02,-5.57e-02,-4.93e-02,-4.36e-02,-3.86e-02,
     + -3.41e-02,-3.02e-02,-2.67e-02,-2.36e-02,-2.09e-02,-1.84e-02,
     + -1.63e-02,-1.44e-02,-1.12e-02,-9.92e-03,-8.75e-03,-7.71e-03,
     + -6.79e-03,-5.97e-03,-5.25e-03,-4.61e-03,-4.05e-03,-3.55e-03,
     + -3.10e-03,-2.71e-03,-2.36e-03,-2.05e-03,-1.78e-03,-1.54e-03,
     + -1.32e-03,-1.13e-03,-9.67e-04,-8.18e-04,-6.86e-04,-5.69e-04,
     + -4.65e-04,-3.37e-04,-2.92e-04,-2.20e-04,-1.56e-04,-1.00e-04,
     + -5.00e-05,0.00e+00,5.00e-05,1.00e-04,1.56e-04,2.20e-04,
     + 2.92e-04,3.37e-04,4.65e-04,5.69e-04,6.86e-04,8.18e-04,
     + 9.67e-04,1.13e-03,1.32e-03,1.54e-03,1.78e-03,2.05e-03,
     + 2.36e-03,2.71e-03,3.10e-03,3.55e-03,4.05e-03,4.61e-03,
     + 5.25e-03,5.97e-03,6.79e-03,7.71e-03,8.75e-03,9.92e-03,
     + 1.12e-02,1.44e-02,1.63e-02,1.84e-02,2.09e-02,2.36e-02,
     + 2.67e-02,3.02e-02,3.41e-02,3.86e-02,4.36e-02,4.93e-02,
     + 5.57e-02,6.30e-02,7.11e-02,8.03e-02,9.07e-02,1.03e-01,
     + 1.15e-01,1.31e-01,1.47e-01,1.67e-01,1.88e-01,2.13e-01,
     + 2.40e-01,2.71e-01,3.06e-01,3.46e-01,3.90e-01,4.41e-01,
     + 5.00e-01/)
C
C --------------- CORRESPONDING STIFFNESS COMPONENTS ------------------
C
      A11=(/ 0.000000e+00, 1.540592e+08, 1.540592e+08, 1.668363e+08,
     +  1.934312e+08, 2.146581e+08, 2.325321e+08, 2.521745e+08,
     +  2.898221e+08, 3.583806e+08, 4.129360e+08, 4.443537e+08,
     +  4.613849e+08, 4.728525e+08, 4.805559e+08, 4.867212e+08,
     +  4.917791e+08, 4.962567e+08, 5.002092e+08, 5.033222e+08,
     +  5.056900e+08, 5.069167e+08, 5.065724e+08, 5.046278e+08,
     +  5.013826e+08, 4.986876e+08, 5.002148e+08, 5.135395e+08,
     +  5.426580e+08, 5.889263e+08, 6.460393e+08, 7.137695e+08,
     +  7.811350e+08, 8.354927e+08, 8.855910e+08, 9.451174e+08,
     +  9.733109e+08, 9.947889e+08, 1.051056e+09, 1.051056e+09,
     +  1.061181e+09, 1.104594e+09, 1.107025e+09, 1.136080e+09,
     +  1.136080e+09, 1.137704e+09, 1.155047e+09, 1.155047e+09,
     +  1.157387e+09, 1.166785e+09, 1.166785e+09, 1.170788e+09,
     +  1.174213e+09, 1.175089e+09, 1.178991e+09, 1.179498e+09,
     +  1.182099e+09, 1.183134e+09, 1.184414e+09, 1.185680e+09,
     +  1.186666e+09, 1.187432e+09, 1.187902e+09, 1.188659e+09,
     +  1.189622e+09, 1.190826e+09, 1.191981e+09, 1.193034e+09,
     +  1.195179e+09, 1.195865e+09, 1.198621e+09, 1.200003e+09,
     +  1.201103e+09, 1.205976e+09, 1.205976e+09, 1.208425e+09,
     +  1.213345e+09, 1.213345e+09, 1.219063e+09, 1.220796e+09,
     +  1.225602e+09, 1.231002e+09, 1.237226e+09, 1.241211e+09,
     +  1.246017e+09, 1.251043e+09, 1.255528e+09, 1.260289e+09,
     +  1.264970e+09, 1.270167e+09, 1.274728e+09, 1.279086e+09,
     +  1.284059e+09, 1.288091e+09, 1.292680e+09, 1.296489e+09,
     +  1.300290e+09, 1.304077e+09, 1.307398e+09, 1.310514e+09,
     +  1.313280e+09, 1.315746e+09, 1.318028e+09, 1.319956e+09,
     +  1.321541e+09, 1.322813e+09, 1.323758e+09, 1.324386e+09,
     +  1.324723e+09, 1.324766e+09, 1.324495e+09, 1.323967e+09,
     +  1.323117e+09, 1.322006e+09, 1.320574e+09, 1.318864e+09,
     +  1.316850e+09, 1.314493e+09, 1.311795e+09, 1.308716e+09,
     +  1.304849e+09/)
      A21=(/ 0.000000e+00,-9.693811e+07,-9.693811e+07,-1.025656e+08,
     + -1.120478e+08,-1.178909e+08,-1.198963e+08,-1.160366e+08,
     + -1.074045e+08,-9.947186e+07,-8.969874e+07,-8.276677e+07,
     + -7.800936e+07,-7.321219e+07,-6.836976e+07,-6.304795e+07,
     + -5.740836e+07,-5.109000e+07,-4.379765e+07,-3.579722e+07,
     + -2.620834e+07,-1.336348e+07, 1.830780e+06, 2.176591e+07,
     +  4.786588e+07, 8.033598e+07, 1.171175e+08, 1.559817e+08,
     +  1.838520e+08, 2.009331e+08, 2.064438e+08, 2.047199e+08,
     +  1.995980e+08, 1.952157e+08, 1.912318e+08, 1.887508e+08,
     +  1.875757e+08, 1.880605e+08, 1.893304e+08, 1.893304e+08,
     +  1.903168e+08, 1.945462e+08, 1.949500e+08, 1.997741e+08,
     +  1.997741e+08, 2.001283e+08, 2.039109e+08, 2.039109e+08,
     +  2.045094e+08, 2.069135e+08, 2.069135e+08, 2.080434e+08,
     +  2.090103e+08, 2.092736e+08, 2.104464e+08, 2.106052e+08,
     +  2.114196e+08, 2.117522e+08, 2.121652e+08, 2.125802e+08,
     +  2.129077e+08, 2.131641e+08, 2.133223e+08, 2.135795e+08,
     +  2.139090e+08, 2.143265e+08, 2.147325e+08, 2.151041e+08,
     +  2.158807e+08, 2.161287e+08, 2.171639e+08, 2.176830e+08,
     +  2.181190e+08, 2.200503e+08, 2.200503e+08, 2.210921e+08,
     +  2.231841e+08, 2.231841e+08, 2.258184e+08, 2.266167e+08,
     +  2.290160e+08, 2.318427e+08, 2.353241e+08, 2.376773e+08,
     +  2.406767e+08, 2.440359e+08, 2.472235e+08, 2.508067e+08,
     +  2.545584e+08, 2.590129e+08, 2.631950e+08, 2.674348e+08,
     +  2.725997e+08, 2.770509e+08, 2.824198e+08, 2.871332e+08,
     +  2.920552e+08, 2.971983e+08, 3.019006e+08, 3.064744e+08,
     +  3.106669e+08, 3.145277e+08, 3.182235e+08, 3.214760e+08,
     +  3.242988e+08, 3.267424e+08, 3.288000e+08, 3.304936e+08,
     +  3.319031e+08, 3.330469e+08, 3.339860e+08, 3.346519e+08,
     +  3.351810e+08, 3.355456e+08, 3.357940e+08, 3.359351e+08,
     +  3.359880e+08, 3.359648e+08, 3.358751e+08, 3.357242e+08,
     +  3.354916e+08/)
      A12=(/ 0.000000e+00,-5.442357e+07,-5.442357e+07,-5.951448e+07,
     + -7.249380e+07,-6.939828e+07,-6.550480e+07,-6.039544e+07,
     + -5.404725e+07,-4.654897e+07,-3.754290e+07,-2.848588e+07,
     + -2.057799e+07,-1.543048e+07,-1.386855e+07,-1.523580e+07,
     + -1.749283e+07,-1.852212e+07,-1.780201e+07,-1.418829e+07,
     + -8.909799e+06,-9.782041e+05, 9.787169e+06, 2.093927e+07,
     +  3.383226e+07, 5.084957e+07, 6.802800e+07, 8.615990e+07,
     +  1.052712e+08, 1.246905e+08, 1.438932e+08, 1.670408e+08,
     +  1.865685e+08, 1.994421e+08, 2.221183e+08, 2.317828e+08,
     +  2.509425e+08, 2.509425e+08, 2.742847e+08, 2.770464e+08,
     +  2.770464e+08, 2.927518e+08, 2.957229e+08, 3.058696e+08,
     +  3.070271e+08, 3.070271e+08, 3.131929e+08, 3.139130e+08,
     +  3.142503e+08, 3.181735e+08, 3.181735e+08, 3.194155e+08,
     +  3.208565e+08, 3.210970e+08, 3.225725e+08, 3.227278e+08,
     +  3.236832e+08, 3.240422e+08, 3.245037e+08, 3.249546e+08,
     +  3.253044e+08, 3.255751e+08, 3.257406e+08, 3.260073e+08,
     +  3.263451e+08, 3.267656e+08, 3.271626e+08, 3.275388e+08,
     +  3.282568e+08, 3.285198e+08, 3.293915e+08, 3.299374e+08,
     +  3.301096e+08, 3.319409e+08, 3.319409e+08, 3.323105e+08,
     +  3.343261e+08, 3.343261e+08, 3.354622e+08, 3.366116e+08,
     +  3.371466e+08, 3.389963e+08, 3.402810e+08, 3.414095e+08,
     +  3.420256e+08, 3.427701e+08, 3.435273e+08, 3.439567e+08,
     +  3.442765e+08, 3.444728e+08, 3.445173e+08, 3.443997e+08,
     +  3.440914e+08, 3.436758e+08, 3.431468e+08, 3.425475e+08,
     +  3.418920e+08, 3.412038e+08, 3.405099e+08, 3.398107e+08,
     +  3.391825e+08, 3.385546e+08, 3.379447e+08, 3.374129e+08,
     +  3.369340e+08, 3.365183e+08, 3.361643e+08, 3.358669e+08,
     +  3.355939e+08, 3.353501e+08, 3.351400e+08, 3.349622e+08,
     +  3.348012e+08, 3.346523e+08, 3.345099e+08, 3.343710e+08,
     +  3.342322e+08, 3.340860e+08, 3.339275e+08, 3.337522e+08,
     +  3.335356e+08/)
      A22=(/ 0.000000e+00, 1.644148e+08, 1.644148e+08, 1.761216e+08,
     +  2.065118e+08, 2.116961e+08, 2.166200e+08, 2.222485e+08,
     +  2.287751e+08, 2.366517e+08, 2.475003e+08, 2.618876e+08,
     +  2.813740e+08, 3.062858e+08, 3.367259e+08, 3.664401e+08,
     +  3.957647e+08, 4.175972e+08, 4.359944e+08, 4.534786e+08,
     +  4.654209e+08, 4.768430e+08, 4.880453e+08, 4.974699e+08,
     +  5.072886e+08, 5.196412e+08, 5.321816e+08, 5.459883e+08,
     +  5.614945e+08, 5.784872e+08, 5.966369e+08, 6.207732e+08,
     +  6.438165e+08, 6.600009e+08, 6.907847e+08, 7.061736e+08,
     +  7.366818e+08, 7.366818e+08, 7.809595e+08, 7.861981e+08,
     +  7.861981e+08, 8.216125e+08, 8.283122e+08, 8.549103e+08,
     +  8.579444e+08, 8.579444e+08, 8.760736e+08, 8.781908e+08,
     +  8.792706e+08, 8.918288e+08, 8.918288e+08, 8.960550e+08,
     +  9.009583e+08, 9.018126e+08, 9.070535e+08, 9.076219e+08,
     +  9.111182e+08, 9.124594e+08, 9.141880e+08, 9.158980e+08,
     +  9.172374e+08, 9.182817e+08, 9.189241e+08, 9.199649e+08,
     +  9.212929e+08, 9.229632e+08, 9.245600e+08, 9.260790e+08,
     +  9.290442e+08, 9.301304e+08, 9.338591e+08, 9.361944e+08,
     +  9.369726e+08, 9.452506e+08, 9.452506e+08, 9.470597e+08,
     +  9.569251e+08, 9.569251e+08, 9.630889e+08, 9.693251e+08,
     +  9.726052e+08, 9.843146e+08, 9.933767e+08, 1.002764e+09,
     +  1.008545e+09, 1.016109e+09, 1.026023e+09, 1.033625e+09,
     +  1.041276e+09, 1.049227e+09, 1.057012e+09, 1.064795e+09,
     +  1.072699e+09, 1.079278e+09, 1.085507e+09, 1.091062e+09,
     +  1.096058e+09, 1.100492e+09, 1.104340e+09, 1.107709e+09,
     +  1.110377e+09, 1.112717e+09, 1.114681e+09, 1.116144e+09,
     +  1.117227e+09, 1.117955e+09, 1.118370e+09, 1.118526e+09,
     +  1.118448e+09, 1.118133e+09, 1.117579e+09, 1.116839e+09,
     +  1.115891e+09, 1.114724e+09, 1.113329e+09, 1.111707e+09,
     +  1.109874e+09, 1.107786e+09, 1.105402e+09, 1.102719e+09,
     +  1.099400e+09/)
      A33=(/ 0.000000e+00, 3.185834e+08, 3.186221e+08, 3.194933e+08,
     +  3.209642e+08, 3.223560e+08, 3.236579e+08, 3.248447e+08,
     +  3.258924e+08, 3.267989e+08, 3.275149e+08, 3.279926e+08,
     +  3.281861e+08, 3.280405e+08, 3.275266e+08, 3.267662e+08,
     +  3.264437e+08, 3.284397e+08, 3.357390e+08, 3.480654e+08,
     +  3.602493e+08, 3.693663e+08, 3.753568e+08, 3.791147e+08,
     +  3.817399e+08, 3.835589e+08, 3.849222e+08, 3.858417e+08,
     +  3.865293e+08, 3.870059e+08, 3.875996e+08, 3.877842e+08,
     +  3.880946e+08, 3.882127e+08, 3.884857e+08, 3.884857e+08,
     +  3.886241e+08, 3.887567e+08, 3.887567e+08, 3.887640e+08,
     +  3.889043e+08, 3.889043e+08, 3.889268e+08, 3.889715e+08,
     +  3.889715e+08, 3.889852e+08, 3.890025e+08, 3.890025e+08,
     +  3.890086e+08, 3.890169e+08, 3.890169e+08, 3.890216e+08,
     +  3.890239e+08, 3.890247e+08, 3.890272e+08, 3.890276e+08,
     +  3.890290e+08, 3.890295e+08, 3.890300e+08, 3.890305e+08,
     +  3.890307e+08, 3.890310e+08, 3.890311e+08, 3.890312e+08,
     +  3.890314e+08, 3.890315e+08, 3.890316e+08, 3.890316e+08,
     +  3.890313e+08, 3.890312e+08, 3.890303e+08, 3.890300e+08,
     +  3.890287e+08, 3.890262e+08, 3.890262e+08, 3.890206e+08,
     +  3.890165e+08, 3.890165e+08, 3.890031e+08, 3.889926e+08,
     +  3.889926e+08, 3.889550e+08, 3.889360e+08, 3.889360e+08,
     +  3.888111e+08, 3.888046e+08, 3.888046e+08, 3.886823e+08,
     +  3.885547e+08, 3.885547e+08, 3.882979e+08, 3.881868e+08,
     +  3.878912e+08, 3.877155e+08, 3.871460e+08, 3.866866e+08,
     +  3.860220e+08, 3.851305e+08, 3.838047e+08, 3.820310e+08,
     +  3.794640e+08, 3.757795e+08, 3.698885e+08, 3.608918e+08,
     +  3.488174e+08, 3.365329e+08, 3.291882e+08, 3.271176e+08,
     +  3.273776e+08, 3.280944e+08, 3.285796e+08, 3.287042e+08,
     +  3.284939e+08, 3.280011e+08, 3.272704e+08, 3.263494e+08,
     +  3.252873e+08, 3.240859e+08, 3.227693e+08, 3.213626e+08,
     +  3.197100e+08/)
      B11=(/ 0.000000e+00,-5.660350e+06,-5.661751e+06,-5.673526e+06,
     + -5.589048e+06,-5.366814e+06,-5.039653e+06,-4.638463e+06,
     + -4.199701e+06,-3.753741e+06,-3.317952e+06,-2.922720e+06,
     + -2.579000e+06,-2.296237e+06,-2.058792e+06,-1.849128e+06,
     + -1.612899e+06,-1.164468e+06, 1.816305e+05, 5.536802e+06,
     +  1.229353e+07, 1.396566e+07, 1.442369e+07, 1.470016e+07,
     +  1.489664e+07, 1.505635e+07, 1.517958e+07, 1.532471e+07,
     +  1.540930e+07, 1.547866e+07, 1.557280e+07, 1.562600e+07,
     +  1.569239e+07, 1.575745e+07, 1.575745e+07, 1.583917e+07,
     +  1.585515e+07, 1.585515e+07, 1.589691e+07, 1.591838e+07,
     +  1.591838e+07, 1.593985e+07, 1.595970e+07, 1.595970e+07,
     +  1.597269e+07, 1.598687e+07, 1.598687e+07, 1.599659e+07,
     +  1.600483e+07, 1.600483e+07, 1.601433e+07, 1.601672e+07,
     +  1.601846e+07, 1.602462e+07, 1.602462e+07, 1.602967e+07,
     +  1.602988e+07, 1.603327e+07, 1.603412e+07, 1.603572e+07,
     +  1.603726e+07, 1.603849e+07, 1.603973e+07, 1.604096e+07,
     +  1.604249e+07, 1.604409e+07, 1.604492e+07, 1.604831e+07,
     +  1.604849e+07, 1.605351e+07, 1.605351e+07, 1.605950e+07,
     +  1.606129e+07, 1.606342e+07, 1.607292e+07, 1.607292e+07,
     +  1.608038e+07, 1.609025e+07, 1.609025e+07, 1.610255e+07,
     +  1.611601e+07, 1.611601e+07, 1.613161e+07, 1.615413e+07,
     +  1.615413e+07, 1.616687e+07, 1.621014e+07, 1.621014e+07,
     +  1.621014e+07, 1.629075e+07, 1.629162e+07, 1.632864e+07,
     +  1.639274e+07, 1.639274e+07, 1.649468e+07, 1.649611e+07,
     +  1.659198e+07, 1.662776e+07, 1.668841e+07, 1.677460e+07,
     +  1.684651e+07, 1.692627e+07, 1.701198e+07, 1.711922e+07,
     +  1.721335e+07, 1.732706e+07, 1.744152e+07, 1.756830e+07,
     +  1.769573e+07, 1.783671e+07, 1.798508e+07, 1.814038e+07,
     +  1.830296e+07, 1.847133e+07, 1.864383e+07, 1.881508e+07,
     +  1.898758e+07, 1.915529e+07, 1.931128e+07, 1.945231e+07,
     +  1.957457e+07/)
      B21=(/ 0.000000e+00,-3.442615e+06,-3.441518e+06,-3.398845e+06,
     + -3.260746e+06,-3.065811e+06,-2.846126e+06,-2.627714e+06,
     + -2.438723e+06,-2.298995e+06,-2.216964e+06,-2.190527e+06,
     + -2.203138e+06,-2.229158e+06,-2.243304e+06,-2.224244e+06,
     + -2.155232e+06,-2.012726e+06,-1.725947e+06,-8.962912e+05,
     +  1.948461e+02, 1.691931e+05, 2.058706e+05, 2.315191e+05,
     +  2.538849e+05, 2.749817e+05, 2.930244e+05, 3.167870e+05,
     +  3.323760e+05, 3.451566e+05, 3.645412e+05, 3.754970e+05,
     +  3.906012e+05, 4.054016e+05, 4.054016e+05, 4.255494e+05,
     +  4.294892e+05, 4.294892e+05, 4.403931e+05, 4.459991e+05,
     +  4.459991e+05, 4.518165e+05, 4.571919e+05, 4.571919e+05,
     +  4.607965e+05, 4.647321e+05, 4.647321e+05, 4.674713e+05,
     +  4.697925e+05, 4.697925e+05, 4.725002e+05, 4.731804e+05,
     +  4.736791e+05, 4.754455e+05, 4.754455e+05, 4.768998e+05,
     +  4.769583e+05, 4.779394e+05, 4.781840e+05, 4.786488e+05,
     +  4.790943e+05, 4.794508e+05, 4.798105e+05, 4.801672e+05,
     +  4.806132e+05, 4.810785e+05, 4.813218e+05, 4.823098e+05,
     +  4.823625e+05, 4.838323e+05, 4.838323e+05, 4.855950e+05,
     +  4.861202e+05, 4.867492e+05, 4.895609e+05, 4.895609e+05,
     +  4.917904e+05, 4.947412e+05, 4.947412e+05, 4.984710e+05,
     +  5.025539e+05, 5.025539e+05, 5.073858e+05, 5.143633e+05,
     +  5.143633e+05, 5.184359e+05, 5.322647e+05, 5.322647e+05,
     +  5.322647e+05, 5.591955e+05, 5.594853e+05, 5.725589e+05,
     +  5.951972e+05, 5.951972e+05, 6.334127e+05, 6.339477e+05,
     +  6.719700e+05, 6.868408e+05, 7.121363e+05, 7.497459e+05,
     +  7.823257e+05, 8.195692e+05, 8.608933e+05, 9.145086e+05,
     +  9.631923e+05, 1.023920e+06, 1.087068e+06, 1.159284e+06,
     +  1.234274e+06, 1.320316e+06, 1.414469e+06, 1.517586e+06,
     +  1.631084e+06, 1.755735e+06, 1.892191e+06, 2.038322e+06,
     +  2.198831e+06, 2.371744e+06, 2.553418e+06, 2.744648e+06,
     +  2.947545e+06/)
      B12=(/ 0.000000e+00,-7.741237e+05,-7.741237e+05,-7.721855e+05,
     + -7.434711e+05,-7.089472e+05,-6.761374e+05,-6.456191e+05,
     + -6.182414e+05,-5.947171e+05,-5.758270e+05,-5.609783e+05,
     + -5.477373e+05,-5.285151e+05,-4.836362e+05,-3.894746e+05,
     + -2.382803e+05,-6.074696e+04, 8.443759e+04, 1.880422e+05,
     +  2.586943e+05, 3.079185e+05, 3.423506e+05, 3.675008e+05,
     +  3.858121e+05, 4.007972e+05, 4.121630e+05, 4.205477e+05,
     +  4.293390e+05, 4.347926e+05, 4.379668e+05, 4.451865e+05,
     +  4.478713e+05, 4.535629e+05, 4.535629e+05, 4.558542e+05,
     +  4.590577e+05, 4.590577e+05, 4.603560e+05, 4.626420e+05,
     +  4.626420e+05, 4.633609e+05, 4.649998e+05, 4.649998e+05,
     +  4.654995e+05, 4.665585e+05, 4.665585e+05, 4.669925e+05,
     +  4.675922e+05, 4.675922e+05, 4.680739e+05, 4.682790e+05,
     +  4.683485e+05, 4.687357e+05, 4.687357e+05, 4.690158e+05,
     +  4.690398e+05, 4.692282e+05, 4.692820e+05, 4.693773e+05,
     +  4.694671e+05, 4.695391e+05, 4.696110e+05, 4.696828e+05,
     +  4.697726e+05, 4.698670e+05, 4.699185e+05, 4.701092e+05,
     +  4.701267e+05, 4.704118e+05, 4.704118e+05, 4.707733e+05,
     +  4.708649e+05, 4.710027e+05, 4.715435e+05, 4.715435e+05,
     +  4.719794e+05, 4.725582e+05, 4.725582e+05, 4.732288e+05,
     +  4.740738e+05, 4.740738e+05, 4.747899e+05, 4.763344e+05,
     +  4.763344e+05, 4.764717e+05, 4.797005e+05, 4.797005e+05,
     +  4.797005e+05, 4.831303e+05, 4.847082e+05, 4.852328e+05,
     +  4.911308e+05, 4.911308e+05, 4.926203e+05, 4.980122e+05,
     +  4.980122e+05, 5.042217e+05, 5.049791e+05, 5.116982e+05,
     +  5.140618e+05, 5.195510e+05, 5.253647e+05, 5.303500e+05,
     +  5.361251e+05, 5.446380e+05, 5.527345e+05, 5.617292e+05,
     +  5.717688e+05, 5.829474e+05, 5.960819e+05, 6.101803e+05,
     +  6.274651e+05, 6.469272e+05, 6.657636e+05, 6.901506e+05,
     +  7.135934e+05, 7.402281e+05, 7.692911e+05, 7.994224e+05,
     +  8.326258e+05/)
      B22=(/ 0.000000e+00,-2.689346e+06,-2.689346e+06,-2.683575e+06,
     + -2.598400e+06,-2.497018e+06,-2.401160e+06,-2.311165e+06,
     + -2.227484e+06,-2.149384e+06,-2.075236e+06,-1.998290e+06,
     + -1.904235e+06,-1.766136e+06,-1.522453e+06,-1.126434e+06,
     + -5.956949e+05,-3.858583e+04, 3.860836e+05, 6.785527e+05,
     +  8.757379e+05, 1.013793e+06, 1.111832e+06, 1.184970e+06,
     +  1.239455e+06, 1.285184e+06, 1.320735e+06, 1.347532e+06,
     +  1.376292e+06, 1.394609e+06, 1.405271e+06, 1.430217e+06,
     +  1.439666e+06, 1.459924e+06, 1.459924e+06, 1.468260e+06,
     +  1.479914e+06, 1.479914e+06, 1.484750e+06, 1.493265e+06,
     +  1.493265e+06, 1.495976e+06, 1.502157e+06, 1.502157e+06,
     +  1.504058e+06, 1.508086e+06, 1.508086e+06, 1.509745e+06,
     +  1.512039e+06, 1.512039e+06, 1.513889e+06, 1.514676e+06,
     +  1.514944e+06, 1.516435e+06, 1.516435e+06, 1.517515e+06,
     +  1.517608e+06, 1.518335e+06, 1.518543e+06, 1.518911e+06,
     +  1.519258e+06, 1.519537e+06, 1.519815e+06, 1.520093e+06,
     +  1.520440e+06, 1.520806e+06, 1.521005e+06, 1.521745e+06,
     +  1.521812e+06, 1.522919e+06, 1.522919e+06, 1.524324e+06,
     +  1.524681e+06, 1.525218e+06, 1.527325e+06, 1.527325e+06,
     +  1.529032e+06, 1.531297e+06, 1.531297e+06, 1.533937e+06,
     +  1.537265e+06, 1.537265e+06, 1.540111e+06, 1.546249e+06,
     +  1.546249e+06, 1.546800e+06, 1.559764e+06, 1.559764e+06,
     +  1.559764e+06, 1.573827e+06, 1.580297e+06, 1.582499e+06,
     +  1.607254e+06, 1.607254e+06, 1.613666e+06, 1.636874e+06,
     +  1.636874e+06, 1.664200e+06, 1.667533e+06, 1.697597e+06,
     +  1.708262e+06, 1.733075e+06, 1.759440e+06, 1.781998e+06,
     +  1.808067e+06, 1.846119e+06, 1.881717e+06, 1.920575e+06,
     +  1.963049e+06, 2.009224e+06, 2.062048e+06, 2.117163e+06,
     +  2.182724e+06, 2.254243e+06, 2.321566e+06, 2.406389e+06,
     +  2.485918e+06, 2.574475e+06, 2.669337e+06, 2.766260e+06,
     +  2.871940e+06/)
      B33=(/ 0.000000e+00, 7.686833e+04, 7.626681e+04, 7.052129e+04,
     +  6.067374e+04, 5.276013e+04, 4.645407e+04, 4.136375e+04,
     +  3.735536e+04, 3.421197e+04, 3.166681e+04, 2.966239e+04,
     +  2.808251e+04, 2.684017e+04, 2.586537e+04, 2.510440e+04,
     +  2.450631e+04, 2.402597e+04, 2.365122e+04, 2.336852e+04,
     +  2.312162e+04, 2.295317e+04, 2.281115e+04, 2.269463e+04,
     +  2.260408e+04, 2.253567e+04, 2.248936e+04, 2.245039e+04,
     +  2.240461e+04, 2.239487e+04, 2.235807e+04, 2.235153e+04,
     +  2.233446e+04, 2.232183e+04, 2.232183e+04, 2.230740e+04,
     +  2.230630e+04, 2.230630e+04, 2.230113e+04, 2.229910e+04,
     +  2.229910e+04, 2.229748e+04, 2.229618e+04, 2.229618e+04,
     +  2.229551e+04, 2.229483e+04, 2.229483e+04, 2.229452e+04,
     +  2.229428e+04, 2.229428e+04, 2.229398e+04, 2.229390e+04,
     +  2.229388e+04, 2.229381e+04, 2.229381e+04, 2.229381e+04,
     +  2.229381e+04, 2.229376e+04, 2.229377e+04, 2.229379e+04,
     +  2.229373e+04, 2.229373e+04, 2.229376e+04, 2.229375e+04,
     +  2.229378e+04, 2.229375e+04, 2.229373e+04, 2.229382e+04,
     +  2.229381e+04, 2.229377e+04, 2.229377e+04, 2.229387e+04,
     +  2.229390e+04, 2.229398e+04, 2.229430e+04, 2.229430e+04,
     +  2.229449e+04, 2.229472e+04, 2.229472e+04, 2.229546e+04,
     +  2.229619e+04, 2.229619e+04, 2.229756e+04, 2.229927e+04,
     +  2.229927e+04, 2.230122e+04, 2.230619e+04, 2.230619e+04,
     +  2.230730e+04, 2.232184e+04, 2.232184e+04, 2.233447e+04,
     +  2.235153e+04, 2.235807e+04, 2.239487e+04, 2.240461e+04,
     +  2.245042e+04, 2.248931e+04, 2.253560e+04, 2.260412e+04,
     +  2.269444e+04, 2.281131e+04, 2.295304e+04, 2.312155e+04,
     +  2.336852e+04, 2.365140e+04, 2.402576e+04, 2.450647e+04,
     +  2.510430e+04, 2.586538e+04, 2.684030e+04, 2.808243e+04,
     +  2.966232e+04, 3.166688e+04, 3.421176e+04, 3.735552e+04,
     +  4.136387e+04, 4.645411e+04, 5.276001e+04, 6.067392e+04,
     +  7.081331e+04/)
      C11=(/ 0.000000e+00, 2.544985e+06, 2.544985e+06, 2.805427e+06,
     +  3.339514e+06, 3.785167e+06, 4.244777e+06, 4.982613e+06,
     +  6.961702e+06, 1.090112e+07, 1.388953e+07, 1.536781e+07,
     +  1.599053e+07, 1.627572e+07, 1.638148e+07, 1.641603e+07,
     +  1.641687e+07, 1.640242e+07, 1.638124e+07, 1.635986e+07,
     +  1.633934e+07, 1.632125e+07, 1.631041e+07, 1.630830e+07,
     +  1.632189e+07, 1.635814e+07, 1.642393e+07, 1.653107e+07,
     +  1.665120e+07, 1.677072e+07, 1.685980e+07, 1.691278e+07,
     +  1.691773e+07, 1.689104e+07, 1.685340e+07, 1.676344e+07,
     +  1.672084e+07, 1.667158e+07, 1.654253e+07, 1.654253e+07,
     +  1.651203e+07, 1.638126e+07, 1.637254e+07, 1.626835e+07,
     +  1.626835e+07, 1.626187e+07, 1.619276e+07, 1.619276e+07,
     +  1.618280e+07, 1.614278e+07, 1.614278e+07, 1.612500e+07,
     +  1.610978e+07, 1.610578e+07, 1.608796e+07, 1.608560e+07,
     +  1.607350e+07, 1.606863e+07, 1.606260e+07, 1.605659e+07,
     +  1.605187e+07, 1.604820e+07, 1.604595e+07, 1.604229e+07,
     +  1.603763e+07, 1.603176e+07, 1.602610e+07, 1.602093e+07,
     +  1.601027e+07, 1.600686e+07, 1.599293e+07, 1.598594e+07,
     +  1.598024e+07, 1.595499e+07, 1.595499e+07, 1.594186e+07,
     +  1.591550e+07, 1.591550e+07, 1.588365e+07, 1.587400e+07,
     +  1.584617e+07, 1.581416e+07, 1.577601e+07, 1.575090e+07,
     +  1.571974e+07, 1.568595e+07, 1.565481e+07, 1.562065e+07,
     +  1.558587e+07, 1.554565e+07, 1.550882e+07, 1.547218e+07,
     +  1.542830e+07, 1.539087e+07, 1.534589e+07, 1.530613e+07,
     +  1.526400e+07, 1.521861e+07, 1.517525e+07, 1.513059e+07,
     +  1.508660e+07, 1.504238e+07, 1.499530e+07, 1.494838e+07,
     +  1.490146e+07, 1.485394e+07, 1.480630e+07, 1.475889e+07,
     +  1.471034e+07, 1.466094e+07, 1.460835e+07, 1.455898e+07,
     +  1.450558e+07, 1.445255e+07, 1.439671e+07, 1.433984e+07,
     +  1.428100e+07, 1.421931e+07, 1.415490e+07, 1.408711e+07,
     +  1.400808e+07/)
      C21=(/ 0.000000e+00, 7.487778e+04, 7.487778e+04, 8.962746e+04,
     +  9.914708e+04, 1.067623e+05, 1.201647e+05, 1.229323e+05,
     +  1.063437e+05, 9.640119e+04, 4.673245e+04,-7.101718e+03,
     + -4.114524e+04,-6.586360e+04,-8.416705e+04,-1.011015e+05,
     + -1.179944e+05,-1.371226e+05,-1.602605e+05,-1.868387e+05,
     + -2.194331e+05,-2.622617e+05,-3.091301e+05,-3.626287e+05,
     + -4.167640e+05,-4.606863e+05,-4.777997e+05,-4.448153e+05,
     + -3.598513e+05,-2.352975e+05,-1.002540e+05, 3.783454e+04,
     +  1.537287e+05, 2.335455e+05, 3.013158e+05, 3.624797e+05,
     +  3.914488e+05, 4.065850e+05, 4.462381e+05, 4.462381e+05,
     +  4.504430e+05, 4.684733e+05, 4.689297e+05, 4.743835e+05,
     +  4.743835e+05, 4.744333e+05, 4.749655e+05, 4.749655e+05,
     +  4.747869e+05, 4.740698e+05, 4.740698e+05, 4.734733e+05,
     +  4.729629e+05, 4.727896e+05, 4.720173e+05, 4.719002e+05,
     +  4.712999e+05, 4.710384e+05, 4.707109e+05, 4.703702e+05,
     +  4.700946e+05, 4.698748e+05, 4.697373e+05, 4.695108e+05,
     +  4.692157e+05, 4.688339e+05, 4.684532e+05, 4.681022e+05,
     +  4.673386e+05, 4.670947e+05, 4.660200e+05, 4.654811e+05,
     +  4.649961e+05, 4.628471e+05, 4.628471e+05, 4.615951e+05,
     +  4.590808e+05, 4.590808e+05, 4.556762e+05, 4.546445e+05,
     +  4.513485e+05, 4.473427e+05, 4.422111e+05, 4.386406e+05,
     +  4.339648e+05, 4.285648e+05, 4.233062e+05, 4.172550e+05,
     +  4.107574e+05, 4.028265e+05, 3.951603e+05, 3.871671e+05,
     +  3.770845e+05, 3.680620e+05, 3.566982e+05, 3.462104e+05,
     +  3.346939e+05, 3.218595e+05, 3.092628e+05, 2.960558e+05,
     +  2.829201e+05, 2.697010e+05, 2.557468e+05, 2.420865e+05,
     +  2.287982e+05, 2.158124e+05, 2.033636e+05, 1.916032e+05,
     +  1.802510e+05, 1.694349e+05, 1.587586e+05, 1.494985e+05,
     +  1.402846e+05, 1.319244e+05, 1.239072e+05, 1.165012e+05,
     +  1.095760e+05, 1.030379e+05, 9.690706e+04, 9.113104e+04,
     +  8.516487e+04/)
      C12=(/ 0.000000e+00,-9.784363e+05,-9.784363e+05,-8.741393e+05,
     + -4.798558e+05,-4.094750e+05,-3.431332e+05,-2.677331e+05,
     + -1.820854e+05,-8.283048e+04, 4.485386e+04, 1.982051e+05,
     +  3.809032e+05, 5.797876e+05, 7.756343e+05, 9.146615e+05,
     +  9.965387e+05, 1.009897e+06, 9.820296e+05, 9.125193e+05,
     +  8.379305e+05, 7.498033e+05, 6.554873e+05, 5.783892e+05,
     +  5.069098e+05, 4.348868e+05, 3.821830e+05, 3.433185e+05,
     +  3.174224e+05, 3.043616e+05, 3.024206e+05, 3.142287e+05,
     +  3.370045e+05, 3.557109e+05, 3.971203e+05, 4.214346e+05,
     +  4.696371e+05, 4.696371e+05, 5.452811e+05, 5.542309e+05,
     +  5.542309e+05, 6.164035e+05, 6.281655e+05, 6.748979e+05,
     +  6.802289e+05, 6.802289e+05, 7.118110e+05, 7.154993e+05,
     +  7.173622e+05, 7.390287e+05, 7.390287e+05, 7.462596e+05,
     +  7.546489e+05, 7.561011e+05, 7.650105e+05, 7.659724e+05,
     +  7.718887e+05, 7.741506e+05, 7.770646e+05, 7.799413e+05,
     +  7.821909e+05, 7.839427e+05, 7.850194e+05, 7.867620e+05,
     +  7.889825e+05, 7.917706e+05, 7.944303e+05, 7.969588e+05,
     +  8.018748e+05, 8.036757e+05, 8.098189e+05, 8.136663e+05,
     +  8.149357e+05, 8.284379e+05, 8.284379e+05, 8.313452e+05,
     +  8.471989e+05, 8.471989e+05, 8.569128e+05, 8.667409e+05,
     +  8.717928e+05, 8.897150e+05, 9.033130e+05, 9.169914e+05,
     +  9.252415e+05, 9.359011e+05, 9.493540e+05, 9.592799e+05,
     +  9.689594e+05, 9.786251e+05, 9.876345e+05, 9.961015e+05,
     +  1.004006e+06, 1.009952e+06, 1.014966e+06, 1.018794e+06,
     +  1.021579e+06, 1.023360e+06, 1.024187e+06, 1.024123e+06,
     +  1.023325e+06, 1.021723e+06, 1.019241e+06, 1.016165e+06,
     +  1.012396e+06, 1.008063e+06, 1.003289e+06, 9.981897e+05,
     +  9.922062e+05, 9.854208e+05, 9.779290e+05, 9.700114e+05,
     +  9.612844e+05, 9.516682e+05, 9.410726e+05, 9.295087e+05,
     +  9.171028e+05, 9.035937e+05, 8.887729e+05, 8.727210e+05,
     +  8.536331e+05/)
      C22=(/ 0.000000e+00, 1.005292e+05, 1.005292e+05, 4.134977e+04,
     +  3.491469e+05, 4.233929e+05, 4.721414e+05, 5.228346e+05,
     +  5.754151e+05, 6.292294e+05, 6.868292e+05, 7.397447e+05,
     +  7.823353e+05, 8.056051e+05, 8.032416e+05, 7.802338e+05,
     +  7.485529e+05, 7.244460e+05, 7.071660e+05, 6.966950e+05,
     +  6.953555e+05, 7.003202e+05, 7.121020e+05, 7.273388e+05,
     +  7.469866e+05, 7.750116e+05, 8.048024e+05, 8.371685e+05,
     +  8.717634e+05, 9.069565e+05, 9.414239e+05, 9.818422e+05,
     +  1.013887e+06, 1.033995e+06, 1.067082e+06, 1.078255e+06,
     +  1.100406e+06, 1.100406e+06, 1.116291e+06, 1.118170e+06,
     +  1.118170e+06, 1.118646e+06, 1.118736e+06, 1.111475e+06,
     +  1.110647e+06, 1.110647e+06, 1.101877e+06, 1.100852e+06,
     +  1.100168e+06, 1.092210e+06, 1.092210e+06, 1.089084e+06,
     +  1.085458e+06, 1.084764e+06, 1.080504e+06, 1.080014e+06,
     +  1.076997e+06, 1.075794e+06, 1.074236e+06, 1.072659e+06,
     +  1.071403e+06, 1.070411e+06, 1.069794e+06, 1.068785e+06,
     +  1.067482e+06, 1.065816e+06, 1.064190e+06, 1.062635e+06,
     +  1.059490e+06, 1.058338e+06, 1.054177e+06, 1.051571e+06,
     +  1.050635e+06, 1.040685e+06, 1.040685e+06, 1.038293e+06,
     +  1.025248e+06, 1.025248e+06, 1.016176e+06, 1.006997e+06,
     +  1.001620e+06, 9.819140e+05, 9.654248e+05, 9.465177e+05,
     +  9.341127e+05, 9.172827e+05, 8.929335e+05, 8.725480e+05,
     +  8.506576e+05, 8.261569e+05, 8.001256e+05, 7.716602e+05,
     +  7.395735e+05, 7.098743e+05, 6.788531e+05, 6.481251e+05,
     +  6.173228e+05, 5.866896e+05, 5.567043e+05, 5.267775e+05,
     +  4.996852e+05, 4.719743e+05, 4.439474e+05, 4.181748e+05,
     +  3.934358e+05, 3.702942e+05, 3.490291e+05, 3.296991e+05,
     +  3.103814e+05, 2.916291e+05, 2.740702e+05, 2.581192e+05,
     +  2.429354e+05, 2.285066e+05, 2.147706e+05, 2.018117e+05,
     +  1.897498e+05, 1.783105e+05, 1.673574e+05, 1.569925e+05,
     +  1.462667e+05/)
      C33=(/ 0.000000e+00, 3.647644e+04, 3.663361e+04, 4.037344e+04,
     +  4.735498e+04, 5.495433e+04, 6.317466e+04, 7.192544e+04,
     +  8.112980e+04, 9.099295e+04, 1.013959e+05, 1.122764e+05,
     +  1.237873e+05, 1.360768e+05, 1.493047e+05, 1.635227e+05,
     +  1.772268e+05, 1.866171e+05, 1.842528e+05, 1.669348e+05,
     +  1.443449e+05, 1.250084e+05, 1.112023e+05, 1.020420e+05,
     +  9.537762e+04, 9.062025e+04, 8.697565e+04, 8.447660e+04,
     +  8.258949e+04, 8.127447e+04, 7.962903e+04, 7.911934e+04,
     +  7.826197e+04, 7.794011e+04, 7.719650e+04, 7.719650e+04,
     +  7.683290e+04, 7.648434e+04, 7.648434e+04, 7.646651e+04,
     +  7.612482e+04, 7.612482e+04, 7.607705e+04, 7.598221e+04,
     +  7.598221e+04, 7.595958e+04, 7.593083e+04, 7.593083e+04,
     +  7.592461e+04, 7.591608e+04, 7.591608e+04, 7.591535e+04,
     +  7.591500e+04, 7.591580e+04, 7.591812e+04, 7.591890e+04,
     +  7.592197e+04, 7.592372e+04, 7.592582e+04, 7.592825e+04,
     +  7.593035e+04, 7.593205e+04, 7.593318e+04, 7.593509e+04,
     +  7.593762e+04, 7.594108e+04, 7.594477e+04, 7.594800e+04,
     +  7.595620e+04, 7.595828e+04, 7.597169e+04, 7.597633e+04,
     +  7.598711e+04, 7.600925e+04, 7.600925e+04, 7.604545e+04,
     +  7.607180e+04, 7.607180e+04, 7.614081e+04, 7.619512e+04,
     +  7.619512e+04, 7.636226e+04, 7.644643e+04, 7.644643e+04,
     +  7.694559e+04, 7.697164e+04, 7.697164e+04, 7.742842e+04,
     +  7.790493e+04, 7.790493e+04, 7.882176e+04, 7.921860e+04,
     +  8.024038e+04, 8.084781e+04, 8.277002e+04, 8.428691e+04,
     +  8.645134e+04, 8.929928e+04, 9.342839e+04, 9.879383e+04,
     +  1.062830e+05, 1.165472e+05, 1.319834e+05, 1.535833e+05,
     +  1.789087e+05, 1.988157e+05, 2.029563e+05, 1.948364e+05,
     +  1.824640e+05, 1.698181e+05, 1.583250e+05, 1.478757e+05,
     +  1.382543e+05, 1.292710e+05, 1.207503e+05, 1.127064e+05,
     +  1.052097e+05, 9.807371e+04, 9.134741e+04, 8.509383e+04,
     +  7.871178e+04/)
      D11=(/ 0.000000e+00, 8.607271e+04, 8.577306e+04, 7.751246e+04,
     +  6.032933e+04, 4.280153e+04, 2.657545e+04, 1.242825e+04,
     +  9.991398e+02,-7.757926e+03,-1.435638e+04,-1.920032e+04,
     + -2.280879e+04,-2.542021e+04,-2.705085e+04,-2.715683e+04,
     + -2.378984e+04,-8.953167e+03, 5.658141e+04, 3.883787e+05,
     +  8.677691e+05, 9.951629e+05, 1.025430e+06, 1.040301e+06,
     +  1.049626e+06, 1.056870e+06, 1.062387e+06, 1.068914e+06,
     +  1.072805e+06, 1.075995e+06, 1.080474e+06, 1.083006e+06,
     +  1.086291e+06, 1.089510e+06, 1.089510e+06, 1.093704e+06,
     +  1.094524e+06, 1.094524e+06, 1.096730e+06, 1.097864e+06,
     +  1.097864e+06, 1.099021e+06, 1.100089e+06, 1.100089e+06,
     +  1.100798e+06, 1.101572e+06, 1.101572e+06, 1.102107e+06,
     +  1.102561e+06, 1.102561e+06, 1.103087e+06, 1.103219e+06,
     +  1.103316e+06, 1.103658e+06, 1.103658e+06, 1.103940e+06,
     +  1.103951e+06, 1.104141e+06, 1.104188e+06, 1.104278e+06,
     +  1.104364e+06, 1.104432e+06, 1.104502e+06, 1.104571e+06,
     +  1.104656e+06, 1.104746e+06, 1.104793e+06, 1.104983e+06,
     +  1.104993e+06, 1.105276e+06, 1.105276e+06, 1.105614e+06,
     +  1.105714e+06, 1.105835e+06, 1.106373e+06, 1.106373e+06,
     +  1.106798e+06, 1.107360e+06, 1.107360e+06, 1.108067e+06,
     +  1.108840e+06, 1.108840e+06, 1.109748e+06, 1.111059e+06,
     +  1.111059e+06, 1.111816e+06, 1.114384e+06, 1.114384e+06,
     +  1.114384e+06, 1.119310e+06, 1.119363e+06, 1.121712e+06,
     +  1.125781e+06, 1.125781e+06, 1.132536e+06, 1.132630e+06,
     +  1.139262e+06, 1.141833e+06, 1.146204e+06, 1.152657e+06,
     +  1.158228e+06, 1.164583e+06, 1.171628e+06, 1.180774e+06,
     +  1.189094e+06, 1.199501e+06, 1.210356e+06, 1.222800e+06,
     +  1.235737e+06, 1.250552e+06, 1.266673e+06, 1.284148e+06,
     +  1.303096e+06, 1.323491e+06, 1.345290e+06, 1.368008e+06,
     +  1.392223e+06, 1.417454e+06, 1.442995e+06, 1.468734e+06,
     +  1.494604e+06/)
      D21=(/ 0.000000e+00,-6.214703e+02,-6.223070e+02,-6.299613e+02,
     + -6.176637e+02,-5.754111e+02,-5.223707e+02,-4.832512e+02,
     + -4.901402e+02,-5.767191e+02,-7.762139e+02,-1.099354e+03,
     + -1.551418e+03,-2.106065e+03,-2.766680e+03,-3.489868e+03,
     + -4.245840e+03,-5.017382e+03,-5.449144e+03,-3.833336e+03,
     + -4.802423e+02, 5.417444e+02, 8.388847e+02, 1.014251e+03,
     +  1.136494e+03, 1.235067e+03, 1.310851e+03, 1.400032e+03,
     +  1.451729e+03, 1.494113e+03, 1.551254e+03, 1.583550e+03,
     +  1.623429e+03, 1.662507e+03, 1.662507e+03, 1.711007e+03,
     +  1.720492e+03, 1.720492e+03, 1.745019e+03, 1.757630e+03,
     +  1.757630e+03, 1.770143e+03, 1.781705e+03, 1.781705e+03,
     +  1.789232e+03, 1.797450e+03, 1.797450e+03, 1.803058e+03,
     +  1.807811e+03, 1.807811e+03, 1.813283e+03, 1.814658e+03,
     +  1.815657e+03, 1.819196e+03, 1.819196e+03, 1.822093e+03,
     +  1.822210e+03, 1.824156e+03, 1.824641e+03, 1.825561e+03,
     +  1.826441e+03, 1.827144e+03, 1.827853e+03, 1.828556e+03,
     +  1.829433e+03, 1.830346e+03, 1.830824e+03, 1.832759e+03,
     +  1.832862e+03, 1.835729e+03, 1.835729e+03, 1.839148e+03,
     +  1.840167e+03, 1.841377e+03, 1.846784e+03, 1.846784e+03,
     +  1.851017e+03, 1.856619e+03, 1.856619e+03, 1.863566e+03,
     +  1.871171e+03, 1.871171e+03, 1.879917e+03, 1.892548e+03,
     +  1.892548e+03, 1.899615e+03, 1.923611e+03, 1.923611e+03,
     +  1.923611e+03, 1.967527e+03, 1.968000e+03, 1.987680e+03,
     +  2.021759e+03, 2.021759e+03, 2.074331e+03, 2.075067e+03,
     +  2.122926e+03, 2.140242e+03, 2.169523e+03, 2.209892e+03,
     +  2.242642e+03, 2.278197e+03, 2.315525e+03, 2.361061e+03,
     +  2.400211e+03, 2.446754e+03, 2.493045e+03, 2.543861e+03,
     +  2.594505e+03, 2.649759e+03, 2.706384e+03, 2.762646e+03,
     +  2.816576e+03, 2.864520e+03, 2.902611e+03, 2.926327e+03,
     +  2.932937e+03, 2.919267e+03, 2.884949e+03, 2.830365e+03,
     +  2.755950e+03/)
      D12=(/ 0.000000e+00,-1.094892e+03,-1.094892e+03,-1.091859e+03,
     + -1.047871e+03,-9.996238e+02,-9.621744e+02,-9.395957e+02,
     + -9.363282e+02,-9.559796e+02,-1.000399e+03,-1.066215e+03,
     + -1.139163e+03,-1.180302e+03,-1.106590e+03,-8.225053e+02,
     + -3.140075e+02, 2.788433e+02, 7.430370e+02, 1.057369e+03,
     +  1.261588e+03, 1.398468e+03, 1.491603e+03, 1.558458e+03,
     +  1.606706e+03, 1.646079e+03, 1.676002e+03, 1.698177e+03,
     +  1.721601e+03, 1.736296e+03, 1.744848e+03, 1.764589e+03,
     +  1.772009e+03, 1.787843e+03, 1.787843e+03, 1.794330e+03,
     +  1.803399e+03, 1.803399e+03, 1.807127e+03, 1.813690e+03,
     +  1.813690e+03, 1.815775e+03, 1.820529e+03, 1.820529e+03,
     +  1.821989e+03, 1.825083e+03, 1.825083e+03, 1.826357e+03,
     +  1.828117e+03, 1.828117e+03, 1.829536e+03, 1.830140e+03,
     +  1.830345e+03, 1.831489e+03, 1.831489e+03, 1.832316e+03,
     +  1.832387e+03, 1.832945e+03, 1.833104e+03, 1.833387e+03,
     +  1.833652e+03, 1.833867e+03, 1.834080e+03, 1.834291e+03,
     +  1.834559e+03, 1.834838e+03, 1.834991e+03, 1.835558e+03,
     +  1.835609e+03, 1.836457e+03, 1.836457e+03, 1.837533e+03,
     +  1.837806e+03, 1.838217e+03, 1.839830e+03, 1.839830e+03,
     +  1.841136e+03, 1.842868e+03, 1.842868e+03, 1.844886e+03,
     +  1.847429e+03, 1.847429e+03, 1.849602e+03, 1.854286e+03,
     +  1.854286e+03, 1.854708e+03, 1.864624e+03, 1.864624e+03,
     +  1.864624e+03, 1.875350e+03, 1.880285e+03, 1.881967e+03,
     +  1.900877e+03, 1.900877e+03, 1.905788e+03, 1.923566e+03,
     +  1.923566e+03, 1.944594e+03, 1.947159e+03, 1.970427e+03,
     +  1.978723e+03, 1.998047e+03, 2.018699e+03, 2.036414e+03,
     +  2.056928e+03, 2.086930e+03, 2.114967e+03, 2.145444e+03,
     +  2.178504e+03, 2.214015e+03, 2.253931e+03, 2.294591e+03,
     +  2.341404e+03, 2.390289e+03, 2.434148e+03, 2.486227e+03,
     +  2.531846e+03, 2.579271e+03, 2.626220e+03, 2.670465e+03,
     +  2.715028e+03/)
      D22=(/ 0.000000e+00, 2.316002e+04, 2.316002e+04, 2.304561e+04,
     +  2.136325e+04, 1.937725e+04, 1.749991e+04, 1.571438e+04,
     +  1.400731e+04, 1.235086e+04, 1.072553e+04, 9.072734e+03,
     +  7.343664e+03, 5.523595e+03, 3.586832e+03, 1.823483e+03,
     +  7.070743e+02, 4.392120e+02, 8.202383e+02, 1.440561e+03,
     +  2.083633e+03, 2.680911e+03, 3.201376e+03, 3.654881e+03,
     +  4.034334e+03, 4.385479e+03, 4.680454e+03, 4.915990e+03,
     +  5.183054e+03, 5.362660e+03, 5.467199e+03, 5.724824e+03,
     +  5.825298e+03, 6.044347e+03, 6.044347e+03, 6.138271e+03,
     +  6.269585e+03, 6.269585e+03, 6.325335e+03, 6.423495e+03,
     +  6.423495e+03, 6.455309e+03, 6.527843e+03, 6.527843e+03,
     +  6.550402e+03, 6.598211e+03, 6.598211e+03, 6.618060e+03,
     +  6.645491e+03, 6.645491e+03, 6.667718e+03, 6.677178e+03,
     +  6.680404e+03, 6.698375e+03, 6.698375e+03, 6.711422e+03,
     +  6.712541e+03, 6.721338e+03, 6.723854e+03, 6.728312e+03,
     +  6.732518e+03, 6.735893e+03, 6.739266e+03, 6.742640e+03,
     +  6.746855e+03, 6.751294e+03, 6.753717e+03, 6.762705e+03,
     +  6.763529e+03, 6.776994e+03, 6.776994e+03, 6.794134e+03,
     +  6.798479e+03, 6.805045e+03, 6.830826e+03, 6.830826e+03,
     +  6.851787e+03, 6.879611e+03, 6.879611e+03, 6.912259e+03,
     +  6.953399e+03, 6.953399e+03, 6.988910e+03, 7.065500e+03,
     +  7.065500e+03, 7.072493e+03, 7.236923e+03, 7.236923e+03,
     +  7.236923e+03, 7.418495e+03, 7.502031e+03, 7.531161e+03,
     +  7.858632e+03, 7.858632e+03, 7.945533e+03, 8.260109e+03,
     +  8.260109e+03, 8.638430e+03, 8.684575e+03, 9.107921e+03,
     +  9.259708e+03, 9.613665e+03, 9.993266e+03, 1.031922e+04,
     +  1.069695e+04, 1.125017e+04, 1.176879e+04, 1.233554e+04,
     +  1.295582e+04, 1.363153e+04, 1.440727e+04, 1.522130e+04,
     +  1.619858e+04, 1.727967e+04, 1.831472e+04, 1.964871e+04,
     +  2.093431e+04, 2.240838e+04, 2.404430e+04, 2.578152e+04,
     +  2.775464e+04/)
      D33=(/ 0.000000e+00, 5.257978e+04, 5.250389e+04, 5.177104e+04,
     +  5.050293e+04, 4.946444e+04, 4.861601e+04, 4.791022e+04,
     +  4.733454e+04, 4.686442e+04, 4.646673e+04, 4.613775e+04,
     +  4.586413e+04, 4.563638e+04, 4.544611e+04, 4.528791e+04,
     +  4.515439e+04, 4.503915e+04, 4.494204e+04, 4.486282e+04,
     +  4.478746e+04, 4.473128e+04, 4.467979e+04, 4.463332e+04,
     +  4.459326e+04, 4.455955e+04, 4.453436e+04, 4.451202e+04,
     +  4.448115e+04, 4.447458e+04, 4.444371e+04, 4.443822e+04,
     +  4.441929e+04, 4.440528e+04, 4.440528e+04, 4.438226e+04,
     +  4.438051e+04, 4.438051e+04, 4.436884e+04, 4.436427e+04,
     +  4.436427e+04, 4.435835e+04, 4.435362e+04, 4.435362e+04,
     +  4.435008e+04, 4.434656e+04, 4.434656e+04, 4.434397e+04,
     +  4.434191e+04, 4.434191e+04, 4.433938e+04, 4.433878e+04,
     +  4.433831e+04, 4.433673e+04, 4.433673e+04, 4.433539e+04,
     +  4.433534e+04, 4.433447e+04, 4.433425e+04, 4.433383e+04,
     +  4.433342e+04, 4.433310e+04, 4.433277e+04, 4.433245e+04,
     +  4.433205e+04, 4.433163e+04, 4.433141e+04, 4.433052e+04,
     +  4.433047e+04, 4.432916e+04, 4.432916e+04, 4.432757e+04,
     +  4.432711e+04, 4.432653e+04, 4.432407e+04, 4.432407e+04,
     +  4.432203e+04, 4.431949e+04, 4.431949e+04, 4.431610e+04,
     +  4.431270e+04, 4.431270e+04, 4.430820e+04, 4.430256e+04,
     +  4.430256e+04, 4.429835e+04, 4.428760e+04, 4.428760e+04,
     +  4.428604e+04, 4.426561e+04, 4.426561e+04, 4.425389e+04,
     +  4.423806e+04, 4.423376e+04, 4.420956e+04, 4.420475e+04,
     +  4.418214e+04, 4.416687e+04, 4.415006e+04, 4.412870e+04,
     +  4.410501e+04, 4.407968e+04, 4.405388e+04, 4.402823e+04,
     +  4.399752e+04, 4.396953e+04, 4.394031e+04, 4.391207e+04,
     +  4.388711e+04, 4.386689e+04, 4.385360e+04, 4.385162e+04,
     +  4.386544e+04, 4.390181e+04, 4.396889e+04, 4.407491e+04,
     +  4.423570e+04, 4.447004e+04, 4.479371e+04, 4.523835e+04,
     +  4.585416e+04/)
C
C -------------------- STATE VARIABLE DEFINITION ----------------------
C
      statev(1)=noel;statev(2)=npt;statev(3)=kstep;statev(4)=kinc;
      statev(5)=kit;statev(6)=time(1);statev(7)=dtime;
	  statev(8)=thick;statev(9)=celent;statev(10)=temp; 
	  statev(11)=dtemp;statev(12)=zero;statev(13)=zero
      k3=0
	  p=1
      do k1=1,3
      do k2=1,3
      statev(14+k3)=basis(k1,k2)
      statev(23+k3)=dfgrd(k1,k2)
      k3=k3+1
      end do
      end do
      statev(32)=curv(1,1);statev(33)=curv(1,2);statev(34)=curv(2,1)
      statev(35)=curv(2,2);statev(36)=tss(1);statev(37)=tss(2)
      statev(38)=coords(1);statev(39)=coords(2);statev(40)=coords(3)
      do k1=1,nsecv
      statev(40+k1)=stran(k1)
      end do
      istatev=40+nsecv
C
C ------------- INITIALISING STIFFNESS AND STRAIN ARRAYS --------------
C
      do ii=1,121
      do jj=1,6
      do kk=1,6
      STIF(ii,jj,kk)=0.0e-15
      e(ii,jj,kk)=1.0e-16
      end do
      end do
      end do
C  
C ------------------- ASSEMBLING STIFFNESS MATRIX ---------------------
C
      do m=1,121
      STIF(m,1,1)=A11(m)
      STIF(m,1,2)=A12(m)
      STIF(m,1,4)=B11(m)
      STIF(m,1,5)=B12(m)
	  STIF(m,2,1)=A21(m)
	  STIF(m,2,2)=A22(m)
	  STIF(m,2,4)=B21(m)
	  STIF(m,2,5)=B22(m)
      STIF(m,3,3)=A33(m)
      STIF(m,3,6)=B33(m)
      STIF(m,4,1)=C11(m)
	  STIF(m,4,2)=C12(m)
	  STIF(m,4,4)=D11(m)
	  STIF(m,4,5)=D12(m)
	  STIF(m,5,1)=C21(m)
	  STIF(m,5,2)=C22(m)
      STIF(m,5,4)=D21(m)
	  STIF(m,5,5)=D22(m)
      STIF(m,6,3)=C33(m)
      STIF(m,6,6)=D33(m)
      end do
C
C ----------------- ASSEMBLING STRAIN POINT MATRIX --------------------
C
      do m=1,121
      e(m,1,1)=e1(m)
      e(m,1,2)=e1(m)
      e(m,1,4)=e2(m)
      e(m,1,5)=e2(m)
      e(m,2,1)=e1(m)
      e(m,2,2)=e1(m)
      e(m,2,4)=e2(m)
      e(m,2,5)=e2(m)
      e(m,3,3)=e1(m)
      e(m,3,6)=e2(m)
      e(m,4,1)=e1(m)
      e(m,4,2)=e1(m)
      e(m,4,4)=e2(m)
      e(m,4,5)=e2(m)
      e(m,5,1)=e1(m)
      e(m,5,2)=e1(m)
      e(m,5,4)=e2(m)
      e(m,5,5)=e2(m)
      e(m,6,3)=e1(m)
      e(m,6,6)=e2(m)
      end do
C
C Loop over force(i) and strain(j)
C
      do i=1,6
      do j=1,6
C
C --------- LOCATE NEAREST STRAIN ID IN STRAIN POINT MATRIX -----------
C
C Check current strain ID
C Start ID=62 if tension / 61 if compression
      stranCurrent = stran(j)
      found = .FALSE.
      IF (ABS(stran(j)) < 1.0E-12) THEN
      curr_ID = 62
      ELSE
      DO ii = 2, 121
      IF (e(ii-1,i,j) .LE. stranCurrent .AND. stranCurrent .LT. e(ii,i,j)) THEN
      curr_ID = ii
      found = .TRUE.
      EXIT
      END IF
      END DO

      IF (.NOT. found) THEN
      ! Handle extrapolation
      IF (stranCurrent .LE. e(1,i,j)) THEN
      curr_ID = 2
      ELSE IF (stranCurrent .GE. e(121,i,j)) THEN
      curr_ID = 121
      END IF
      END IF
      END IF
      stranNext = stran(j) + dstran(j)
      found = .FALSE.
      DO jj = 2, 121
      IF (e(jj-1,i,j) .LE. stranNext .AND. stranNext .LT. e(jj,i,j)) THEN
      next_ID = jj
      found = .TRUE.
      EXIT
      END IF
      END DO

      IF (.NOT. found) THEN
      ! Handle extrapolation
      IF (stranNext .LE. e(1,i,j)) THEN
      next_ID = 2
      ELSE IF (stranNext .GE. e(121,i,j)) THEN
      next_ID = 121
      END IF
      END IF
C
C ----------------- UPDATE TANGENT STIFFNESS MATRIX -------------------
C	  
      ddndde(i,j)=STIF(curr_ID,i,j)
C
C Initial tangent stiffness matrix can be used as	  
C      ddndde(i,j)=props(p)
C      p=p+1
C
C ------------------- UPDATE FORCES AND MOMENTS -----------------------
C
      curr_stran_modif=sign(1.0,dstran(j))
      n=next_ID-curr_ID
      IF (SIGN(1.0, stranCurrent) == curr_stran_modif) THEN
      IF (n == 0) THEN
      ! No interval crossed, use local stiffness
      force(i) = force(i) + STIF(curr_ID,i,j) * dstran(j)
      ELSE IF (n > 0) THEN
      ! Tension interpolation
      e_int1 = e(curr_ID,i,j) - stranCurrent
      e_int2 = stranNext - e(curr_ID+n-1,i,j)
      force(i) = force(i) + STIF(curr_ID,i,j) * e_int1
      force(i) = force(i) + STIF(curr_ID+n,i,j) * e_int2
      DO k = 2, n
      idx1 = curr_ID + k - 1
      idx2 = curr_ID + k - 2
      force(i) = force(i) + STIF(idx1,i,j) * (e(idx1,i,j) - e(idx2,i,j))
	  END DO
	  ELSE
      ! Compression interpolation
      e_int1 = e(curr_ID-1,i,j) - stranCurrent
      e_int2 = stranNext - e(curr_ID+n,i,j)

      force(i) = force(i) + STIF(curr_ID,i,j) * e_int1
      force(i) = force(i) + STIF(curr_ID+n,i,j) * e_int2

      DO k = -2, n, -1
      idx1 = curr_ID + k + 1
      idx2 = curr_ID + k
      force(i) = force(i) + STIF(idx1,i,j) * (e(idx2,i,j) - e(idx1,i,j))
	  END DO
      END IF
      END IF

C CASE 2: Increment is in opposite same direction as strain
      IF (SIGN(1.0, stranCurrent) /= SIGN(1.0, dstran(j))) THEN

      IF (n == 0) THEN
      ! No interval crossed, use local stiffness
      force(i) = force(i) + STIF(curr_ID,i,j) * dstran(j)      
	  ELSE IF (n < 0) THEN
      ! Reverse tension interpolation (moving toward compression)
      e_int1 = stranCurrent - e(curr_ID-1,i,j)
      e_int2 = e(curr_ID+n,i,j) - stranNext

      force(i) = force(i) - STIF(curr_ID,i,j) * e_int1
      force(i) = force(i) - STIF(curr_ID+n,i,j) * e_int2
      DO k = -2, n, -1
      idx1 = curr_ID + k + 1
      idx2 = curr_ID + k
      force(i) = force(i) - STIF(idx1,i,j) * (e(idx1,i,j) - e(idx2,i,j))
      END DO
      ELSE
      ! Reverse compression interpolation (moving toward tension)
      e_int1 = stranCurrent - e(curr_ID,i,j)
      e_int2 = e(curr_ID+n-1,i,j) - stranNext

      force(i) = force(i) - STIF(curr_ID,i,j) * e_int1
      force(i) = force(i) - STIF(curr_ID+n,i,j) * e_int2

      DO k = 2, n
      idx1 = curr_ID + k - 1
      idx2 = curr_ID + k - 2
      force(i) = force(i) - STIF(idx1,i,j) * (e(idx2,i,j) - e(idx1,i,j))
      END DO
      END IF
      END IF
C ----------------------------------------------------------------------
      end do
      statev(istatev+i)=force(i)
      end do
999   continue
      deallocate(A11, A12, A21, A22, A33,
     + B11, B12, B21, B22, B33,
     + C11, C12, C21, C22, C33,
     + D11, D12, D21, D22, D33,
     + e1, e2, STIF, e)
      return
      end