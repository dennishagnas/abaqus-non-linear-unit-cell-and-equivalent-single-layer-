C ---------------------------------------------------------------------
C 
C Abaqus UGENS script for defining non-linear ESL element stiffness
C
C ---------------------------------------------------------------------
	  !DEC$ ATTRIBUTES ALIAS:"ugens"::UGENS
	  subroutine UGENS(ddndde,force,statev,sse,spd,pnewdt,stran,dstran,
     1 tss,time,dtime,temp,dtemp,predef,dpred,cename,ndi,nshr,nsecv,
     2 nstatv,props,jprops,nprops,njprop,coords,celent,thick,dfgrd,
     3 curv,basis,noel,npt,kstep,kinc,kit,linper )
C
      include 'aba_param.inc'
C
      character*80 cename
      dimension force(nsecv),statev(nstatv),ddndde(nsecv,nsecv),
     1 stran(nsecv),dstran(nsecv),predef(*),dpred(*),
     2 props(*),jprops(*),coords(3),time(2),dfgrd(3,3),
     3 curv(2,2),basis(3,3),tss(*)
	  real*8, allocatable :: A11(:),A12(:),A21(:),A22(:)
      real*8, allocatable :: A33(:),B11(:),B12(:),B21(:)
      real*8, allocatable :: B22(:),B33(:),C11(:),C12(:)
      real*8, allocatable :: C21(:),C22(:),C33(:),D11(:)
      real*8, allocatable :: D12(:),D21(:),D22(:),D33(:)
      real*8, allocatable :: e1(:),e2(:)
      real*8, allocatable :: STIF(:,:,:),e(:,:,:)
      integer i,ii,j,jj,kk,m,k,n,p,curr_ID,next_ID,ij,idx1,idx2
      REAL :: stranCurrent, stranNext
      LOGICAL :: found
      double precision e_int1,e_int2
      parameter (zero=0.0d0,half=0.5d0)
      allocate(A11(121),A12(121),A21(121),A22(121),A33(121),B11(121))
      allocate(B12(121),B21(121),B22(121),B33(121),C11(121),C12(121))
	  allocate(C21(121),C22(121),C33(121),D11(121),D12(121),D21(121))
	  allocate(D22(121),D33(121))
	  allocate(e1(121),e2(121),STIF(121,6,6),e(121,6,6))
C
C ------------------ PRE-DEFINED STRAIN INTERVALS ---------------------
C
      e1=(/-1.05e-02,-1.00e-02,-9.78e-03,-8.79e-03,-7.89e-03,-7.09e-03, 
     + -6.36e-03,-5.72e-03,-5.14e-03,-4.61e-03,-4.14e-03,-3.72e-03,
     + -3.34e-03,-3.00e-03,-2.69e-03,-2.41e-03,-2.17e-03,-1.95e-03,
     + -1.75e-03,-1.57e-03,-1.41e-03,-1.26e-03,-1.13e-03,-1.02e-03,
     + -9.12e-04,-8.18e-04,-7.33e-04,-6.57e-04,-5.89e-04,-5.28e-04,
     + -4.72e-04,-4.23e-04,-3.78e-04,-3.38e-04,-3.02e-04,-2.69e-04,
     + -2.41e-04,-2.14e-04,-1.91e-04,-1.70e-04,-1.51e-04,-1.34e-04,
     + -1.04e-04,-9.25e-05,-8.14e-05,-7.14e-05,-6.25e-05,-5.44e-05,
     + -4.72e-05,-4.07e-05,-3.49e-05,-2.96e-05,-2.49e-05,-2.07e-05,
     + -1.69e-05,-1.35e-05,-1.04e-05,-7.70e-06,-5.22e-06,-3.00e-06,
     + -1.00e-06,0.00e+00,1.00e-06,3.00e-06,5.22e-06,7.70e-06,
     + 1.04e-05,1.35e-05,1.69e-05,2.07e-05,2.49e-05,2.96e-05,
     + 3.49e-05,4.07e-05,4.72e-05,5.44e-05,6.25e-05,7.14e-05,
     + 8.14e-05,9.25e-05,1.04e-04,1.34e-04,1.51e-04,1.70e-04,
     + 1.91e-04,2.14e-04,2.41e-04,2.69e-04,3.02e-04,3.38e-04,
     + 3.78e-04,4.23e-04,4.72e-04,5.28e-04,5.89e-04,6.57e-04,
     + 7.33e-04,8.18e-04,9.12e-04,1.02e-03,1.13e-03,1.26e-03,
     + 1.41e-03,1.57e-03,1.75e-03,1.95e-03,2.17e-03,2.41e-03,
     + 2.69e-03,3.00e-03,3.34e-03,3.72e-03,4.14e-03,4.61e-03,
     + 5.14e-03,5.72e-03,6.36e-03,7.09e-03,7.89e-03,8.79e-03,
     + 1.00e-02/)
	  e2=(/-5.10e-01,-5.00e-01,-4.97e-01,-4.41e-01,-3.90e-01,-3.46e-01,
     + -3.06e-01,-2.71e-01,-2.40e-01,-2.13e-01,-1.88e-01,-1.67e-01,
     + -1.47e-01,-1.31e-01,-1.15e-01,-1.03e-01,-9.07e-02,-8.03e-02,
     + -7.11e-02,-6.30e-02,-5.57e-02,-4.93e-02,-4.36e-02,-3.86e-02,
     + -3.41e-02,-3.02e-02,-2.67e-02,-2.36e-02,-2.09e-02,-1.84e-02,
     + -1.63e-02,-1.44e-02,-1.12e-02,-9.92e-03,-8.75e-03,-7.71e-03,
     + -6.79e-03,-5.97e-03,-5.25e-03,-4.61e-03,-4.05e-03,-3.55e-03,
     + -3.10e-03,-2.71e-03,-2.36e-03,-2.05e-03,-1.78e-03,-1.54e-03,
     + -1.32e-03,-1.13e-03,-9.67e-04,-8.18e-04,-6.86e-04,-5.69e-04,
     + -4.65e-04,-3.37e-04,-2.92e-04,-2.20e-04,-1.56e-04,-1.00e-04,
     + -5.00e-05,0.00e+00,5.00e-05,1.00e-04,1.56e-04,2.20e-04,
     + 2.92e-04,3.37e-04,4.65e-04,5.69e-04,6.86e-04,8.18e-04,
     + 9.67e-04,1.13e-03,1.32e-03,1.54e-03,1.78e-03,2.05e-03,
     + 2.36e-03,2.71e-03,3.10e-03,3.55e-03,4.05e-03,4.61e-03,
     + 5.25e-03,5.97e-03,6.79e-03,7.71e-03,8.75e-03,9.92e-03,
     + 1.12e-02,1.44e-02,1.63e-02,1.84e-02,2.09e-02,2.36e-02,
     + 2.67e-02,3.02e-02,3.41e-02,3.86e-02,4.36e-02,4.93e-02,
     + 5.57e-02,6.30e-02,7.11e-02,8.03e-02,9.07e-02,1.03e-01,
     + 1.15e-01,1.31e-01,1.47e-01,1.67e-01,1.88e-01,2.13e-01,
     + 2.40e-01,2.71e-01,3.06e-01,3.46e-01,3.90e-01,4.41e-01,
     + 5.00e-01/)
C
C --------------- CORRESPONDING STIFFNESS COMPONENTS ------------------
C
      A11=(/ 0.000000e+00, 1.692193e+08, 1.692193e+08, 1.773580e+08,
     +  1.931681e+08, 2.094717e+08, 2.277491e+08, 2.510154e+08,
     +  2.863439e+08, 3.429270e+08, 4.389774e+08, 4.862915e+08,
     +  5.070914e+08, 5.216022e+08, 5.331927e+08, 5.438523e+08,
     +  5.536999e+08, 5.635563e+08, 5.738863e+08, 5.847442e+08,
     +  5.966387e+08, 6.089230e+08, 6.222014e+08, 6.359495e+08,
     +  6.502029e+08, 6.656032e+08, 6.806597e+08, 6.987498e+08,
     +  7.142414e+08, 7.311956e+08, 7.501893e+08, 7.672561e+08,
     +  7.845026e+08, 8.009758e+08, 8.207717e+08, 8.381379e+08,
     +  8.500985e+08, 8.689959e+08, 8.825569e+08, 8.967313e+08,
     +  9.052263e+08, 9.271140e+08, 9.328776e+08, 9.561897e+08,
     +  9.561897e+08, 9.614783e+08, 9.785593e+08, 9.785593e+08,
     +  9.830111e+08, 9.940764e+08, 9.940764e+08, 1.000319e+09,
     +  1.004679e+09, 1.006185e+09, 1.011857e+09, 1.012711e+09,
     +  1.016690e+09, 1.018358e+09, 1.020384e+09, 1.022426e+09,
     +  1.024037e+09, 1.025299e+09, 1.029592e+09, 1.029592e+09,
     +  1.029592e+09, 1.029592e+09, 1.030623e+09, 1.037445e+09,
     +  1.037445e+09, 1.038784e+09, 1.047381e+09, 1.047381e+09,
     +  1.047381e+09, 1.060677e+09, 1.062495e+09, 1.062495e+09,
     +  1.071857e+09, 1.085557e+09, 1.085557e+09, 1.085557e+09,
     +  1.109899e+09, 1.120415e+09, 1.120415e+09, 1.154620e+09,
     +  1.161655e+09, 1.161655e+09, 1.194260e+09, 1.201305e+09,
     +  1.211929e+09, 1.237791e+09, 1.237791e+09, 1.268809e+09,
     +  1.269622e+09, 1.289388e+09, 1.295629e+09, 1.305887e+09,
     +  1.315142e+09, 1.317623e+09, 1.328209e+09, 1.328209e+09,
     +  1.333694e+09, 1.335543e+09, 1.336283e+09, 1.338618e+09,
     +  1.338618e+09, 1.339092e+09, 1.339147e+09, 1.338533e+09,
     +  1.338321e+09, 1.337088e+09, 1.336159e+09, 1.335028e+09,
     +  1.333575e+09, 1.331829e+09, 1.329828e+09, 1.327668e+09,
     +  1.325378e+09, 1.322703e+09, 1.319717e+09, 1.316311e+09,
     +  1.312233e+09/)
      A21=(/ 0.000000e+00,-1.304086e+08,-1.304086e+08,-1.338072e+08,
     + -1.400987e+08,-1.458937e+08,-1.510460e+08,-1.551416e+08,
     + -1.577776e+08,-1.544886e+08,-1.106363e+08,-9.894589e+07,
     + -9.642627e+07,-9.306822e+07,-8.904645e+07,-8.429701e+07,
     + -7.922417e+07,-7.373783e+07,-6.777385e+07,-6.144104e+07,
     + -5.455506e+07,-4.757265e+07,-4.020265e+07,-3.276865e+07,
     + -2.525550e+07,-1.731721e+07,-9.693406e+06,-6.700972e+05,
     +  6.982353e+06, 1.531654e+07, 2.463591e+07, 3.301944e+07,
     +  4.151616e+07, 4.966270e+07, 5.950597e+07, 6.820195e+07,
     +  7.421643e+07, 8.375444e+07, 9.065778e+07, 9.787333e+07,
     +  1.022362e+08, 1.134772e+08, 1.164615e+08, 1.285318e+08,
     +  1.285318e+08, 1.312882e+08, 1.401907e+08, 1.401907e+08,
     +  1.425216e+08, 1.483154e+08, 1.483154e+08, 1.515941e+08,
     +  1.538836e+08, 1.546760e+08, 1.576609e+08, 1.581109e+08,
     +  1.602073e+08, 1.610867e+08, 1.621552e+08, 1.632331e+08,
     +  1.640837e+08, 1.647497e+08, 1.670184e+08, 1.670184e+08,
     +  1.670184e+08, 1.670184e+08, 1.675635e+08, 1.711727e+08,
     +  1.711727e+08, 1.718825e+08, 1.764382e+08, 1.764382e+08,
     +  1.764382e+08, 1.835016e+08, 1.844677e+08, 1.844677e+08,
     +  1.894588e+08, 1.967629e+08, 1.967629e+08, 1.967629e+08,
     +  2.098056e+08, 2.154405e+08, 2.154405e+08, 2.338788e+08,
     +  2.376709e+08, 2.376709e+08, 2.553588e+08, 2.591807e+08,
     +  2.649806e+08, 2.790997e+08, 2.790997e+08, 2.961499e+08,
     +  2.965971e+08, 3.075582e+08, 3.110192e+08, 3.167892e+08,
     +  3.219948e+08, 3.234312e+08, 3.295597e+08, 3.295597e+08,
     +  3.329725e+08, 3.341228e+08, 3.346926e+08, 3.364901e+08,
     +  3.364901e+08, 3.374525e+08, 3.375639e+08, 3.379265e+08,
     +  3.380096e+08, 3.381430e+08, 3.381458e+08, 3.381306e+08,
     +  3.380733e+08, 3.379738e+08, 3.378390e+08, 3.376804e+08,
     +  3.375034e+08, 3.372898e+08, 3.370462e+08, 3.367638e+08,
     +  3.364222e+08/)
      A12=(/ 0.000000e+00, 1.651338e+07, 1.651338e+07, 1.460307e+07,
     +  8.814677e+06, 8.647756e+05,-8.324575e+06,-1.793767e+07,
     + -2.707584e+07,-3.597725e+07,-4.497281e+07,-5.446398e+07,
     + -6.607907e+07,-8.125333e+07,-1.086987e+08,-4.242329e+08,
     + -6.471710e+08,-1.791807e+08,-4.055245e+08, 6.488900e+08,
     + -1.041878e+09, 3.168335e+08, 1.395520e+09,-2.191486e+09,
     + -3.465897e+08, 9.410974e+08,-8.652431e+08, 3.271138e+09,
     + -1.481191e+07, 6.560895e+04, 1.576906e+07, 3.105467e+07,
     +  4.790290e+07, 6.220491e+07, 7.613714e+07, 8.960075e+07,
     +  1.017178e+08, 1.115423e+08, 1.215930e+08, 1.322315e+08,
     +  1.365251e+08, 1.474160e+08, 1.523509e+08, 1.658326e+08,
     +  1.658326e+08, 1.659559e+08, 1.760232e+08, 1.760232e+08,
     +  1.770456e+08, 1.828610e+08, 1.828610e+08, 1.851796e+08,
     +  1.874319e+08, 1.879363e+08, 1.904825e+08, 1.907947e+08,
     +  1.925170e+08, 1.931982e+08, 1.940567e+08, 1.949108e+08,
     +  1.955810e+08, 1.961039e+08, 1.964256e+08, 1.969472e+08,
     +  1.976131e+08, 1.984523e+08, 1.992603e+08, 2.000114e+08,
     +  2.015296e+08, 2.020438e+08, 2.040070e+08, 2.050896e+08,
     +  2.057411e+08, 2.096489e+08, 2.096489e+08, 2.114046e+08,
     +  2.164577e+08, 2.164577e+08, 2.165535e+08, 2.265720e+08,
     +  2.265720e+08, 2.295730e+08, 2.402131e+08, 2.402131e+08,
     +  2.402131e+08, 2.532453e+08, 2.549625e+08, 2.550270e+08,
     +  2.688431e+08, 2.688431e+08, 2.760604e+08, 2.816520e+08,
     +  2.852450e+08, 2.931958e+08, 2.951863e+08, 3.033150e+08,
     +  3.046082e+08, 3.118918e+08, 3.130526e+08, 3.188688e+08,
     +  3.200078e+08, 3.242788e+08, 3.257295e+08, 3.282678e+08,
     +  3.299901e+08, 3.310816e+08, 3.329772e+08, 3.336647e+08,
     +  3.344664e+08, 3.351801e+08, 3.357582e+08, 3.361231e+08,
     +  3.364066e+08, 3.365908e+08, 3.366859e+08, 3.367157e+08,
     +  3.366858e+08, 3.365917e+08, 3.364497e+08, 3.362498e+08,
     +  3.359797e+08/)
      A22=(/ 0.000000e+00, 1.519868e+08, 1.519868e+08, 1.559533e+08,
     +  1.652571e+08, 1.759513e+08, 1.880299e+08, 2.017687e+08,
     +  2.171929e+08, 2.359396e+08, 2.602493e+08, 2.923799e+08,
     +  3.385479e+08, 4.024747e+08, 4.920364e+08, 7.880148e+08,
     +  7.105539e+08, 1.534433e+09, 4.233308e+08, 1.529094e+08,
     +  3.463674e+08, 7.442808e+08,-1.949062e+08, 1.152204e+09,
     + -4.663169e+08, 1.559040e+09,-3.757029e+07, 1.689628e+09,
     +  8.518196e+08, 8.723444e+08, 8.920150e+08, 9.097407e+08,
     +  9.279170e+08, 9.424621e+08, 9.559697e+08, 9.684664e+08,
     +  9.792803e+08, 9.877900e+08, 9.963035e+08, 1.004966e+09,
     +  1.008462e+09, 1.016980e+09, 1.020828e+09, 1.030988e+09,
     +  1.030988e+09, 1.031078e+09, 1.038430e+09, 1.038430e+09,
     +  1.039160e+09, 1.043311e+09, 1.043311e+09, 1.044942e+09,
     +  1.046525e+09, 1.046876e+09, 1.048648e+09, 1.048864e+09,
     +  1.050054e+09, 1.050523e+09, 1.051113e+09, 1.051698e+09,
     +  1.052157e+09, 1.052514e+09, 1.052733e+09, 1.053089e+09,
     +  1.053541e+09, 1.054111e+09, 1.054658e+09, 1.055166e+09,
     +  1.056188e+09, 1.056534e+09, 1.057846e+09, 1.058569e+09,
     +  1.059000e+09, 1.061584e+09, 1.061584e+09, 1.062726e+09,
     +  1.066012e+09, 1.066012e+09, 1.066073e+09, 1.072427e+09,
     +  1.072427e+09, 1.074262e+09, 1.080767e+09, 1.080767e+09,
     +  1.080767e+09, 1.088372e+09, 1.089373e+09, 1.089409e+09,
     +  1.097045e+09, 1.097045e+09, 1.100802e+09, 1.103714e+09,
     +  1.105463e+09, 1.109335e+09, 1.110231e+09, 1.113890e+09,
     +  1.114418e+09, 1.117393e+09, 1.117808e+09, 1.119890e+09,
     +  1.120222e+09, 1.121469e+09, 1.121759e+09, 1.122265e+09,
     +  1.122373e+09, 1.122441e+09, 1.122173e+09, 1.121873e+09,
     +  1.121439e+09, 1.120788e+09, 1.119869e+09, 1.118912e+09,
     +  1.117714e+09, 1.116329e+09, 1.114863e+09, 1.113101e+09,
     +  1.111215e+09, 1.108937e+09, 1.106513e+09, 1.103691e+09,
     +  1.100311e+09/)
      A33=(/ 0.000000e+00, 3.228963e+08, 3.230676e+08, 3.244176e+08,
     +  3.266914e+08, 3.289950e+08, 3.313667e+08, 3.338141e+08,
     +  3.363399e+08, 3.390155e+08, 3.418336e+08, 3.447760e+08,
     +  3.478781e+08, 3.511400e+08, 3.545604e+08, 3.580989e+08,
     +  3.615812e+08, 3.649234e+08, 3.681215e+08, 3.710693e+08,
     +  3.736657e+08, 3.759389e+08, 3.778874e+08, 3.794183e+08,
     +  3.806942e+08, 3.817813e+08, 3.826383e+08, 3.833400e+08,
     +  3.838742e+08, 3.843741e+08, 3.847170e+08, 3.850080e+08,
     +  3.852459e+08, 3.854353e+08, 3.855759e+08, 3.857113e+08,
     +  3.858246e+08, 3.858624e+08, 3.859820e+08, 3.859870e+08,
     +  3.860520e+08, 3.860838e+08, 3.861050e+08, 3.861466e+08,
     +  3.861466e+08, 3.861606e+08, 3.861782e+08, 3.861782e+08,
     +  3.861843e+08, 3.861927e+08, 3.861927e+08, 3.861972e+08,
     +  3.861993e+08, 3.862001e+08, 3.862024e+08, 3.862027e+08,
     +  3.862039e+08, 3.862043e+08, 3.862047e+08, 3.862051e+08,
     +  3.862053e+08, 3.862054e+08, 3.862055e+08, 3.862055e+08,
     +  3.862056e+08, 3.862056e+08, 3.862055e+08, 3.862054e+08,
     +  3.862048e+08, 3.862047e+08, 3.862032e+08, 3.862027e+08,
     +  3.862011e+08, 3.861979e+08, 3.861979e+08, 3.861910e+08,
     +  3.861860e+08, 3.861860e+08, 3.861707e+08, 3.861585e+08,
     +  3.861585e+08, 3.861205e+08, 3.861012e+08, 3.860715e+08,
     +  3.860106e+08, 3.860059e+08, 3.858923e+08, 3.858562e+08,
     +  3.857476e+08, 3.856171e+08, 3.854813e+08, 3.852977e+08,
     +  3.850666e+08, 3.847831e+08, 3.844485e+08, 3.839599e+08,
     +  3.834368e+08, 3.827490e+08, 3.819082e+08, 3.808408e+08,
     +  3.795871e+08, 3.780820e+08, 3.761654e+08, 3.739283e+08,
     +  3.713716e+08, 3.684667e+08, 3.653117e+08, 3.620100e+08,
     +  3.585635e+08, 3.550533e+08, 3.516512e+08, 3.483982e+08,
     +  3.452973e+08, 3.423513e+08, 3.395286e+08, 3.368516e+08,
     +  3.343324e+08, 3.319061e+08, 3.295797e+08, 3.273632e+08,
     +  3.250353e+08/)
      B11=(/ 0.000000e+00,-4.969684e+06,-4.979705e+06,-5.124460e+06,
     + -5.306283e+06,-5.353940e+06,-5.287347e+06,-5.133420e+06,
     + -4.923542e+06,-4.685178e+06,-4.433847e+06,-4.187447e+06,
     + -3.953206e+06,-3.741217e+06,-3.549170e+06,-3.374659e+06,
     + -3.196127e+06,-2.913802e+06,-2.083152e+06, 2.023598e+06,
     +  8.898547e+06, 1.093253e+07, 1.142723e+07, 1.164685e+07,
     +  1.179582e+07, 1.190625e+07, 1.199909e+07, 1.207287e+07,
     +  1.214092e+07, 1.220174e+07, 1.225767e+07, 1.230135e+07,
     +  1.235151e+07, 1.240926e+07, 1.242559e+07, 1.245719e+07,
     +  1.248135e+07, 1.248135e+07, 1.251723e+07, 1.253074e+07,
     +  1.253074e+07, 1.255087e+07, 1.256657e+07, 1.256657e+07,
     +  1.257864e+07, 1.259050e+07, 1.259050e+07, 1.259941e+07,
     +  1.260647e+07, 1.260647e+07, 1.261510e+07, 1.261712e+07,
     +  1.261873e+07, 1.262423e+07, 1.262423e+07, 1.262880e+07,
     +  1.262897e+07, 1.263205e+07, 1.263281e+07, 1.263426e+07,
     +  1.263565e+07, 1.263677e+07, 1.263789e+07, 1.263901e+07,
     +  1.264040e+07, 1.264185e+07, 1.264262e+07, 1.264569e+07,
     +  1.264587e+07, 1.265044e+07, 1.265044e+07, 1.265597e+07,
     +  1.265757e+07, 1.265964e+07, 1.266826e+07, 1.266826e+07,
     +  1.267544e+07, 1.268431e+07, 1.268431e+07, 1.269647e+07,
     +  1.270843e+07, 1.270843e+07, 1.272482e+07, 1.274471e+07,
     +  1.274471e+07, 1.275954e+07, 1.279498e+07, 1.279498e+07,
     +  1.282148e+07, 1.285213e+07, 1.287136e+07, 1.293012e+07,
     +  1.298420e+07, 1.303042e+07, 1.308926e+07, 1.315364e+07,
     +  1.322513e+07, 1.330206e+07, 1.340228e+07, 1.350972e+07,
     +  1.363979e+07, 1.378961e+07, 1.397630e+07, 1.419397e+07,
     +  1.446708e+07, 1.479404e+07, 1.519968e+07, 1.568316e+07,
     +  1.617201e+07, 1.664282e+07, 1.704539e+07, 1.736234e+07,
     +  1.762648e+07, 1.785641e+07, 1.807108e+07, 1.827650e+07,
     +  1.847959e+07, 1.867933e+07, 1.886953e+07, 1.904771e+07,
     +  1.921098e+07/)
      B21=(/ 0.000000e+00,-3.299257e+06,-3.303958e+06,-3.362879e+06,
     + -3.408032e+06,-3.374274e+06,-3.286284e+06,-3.167136e+06,
     + -3.039988e+06,-2.922432e+06,-2.824890e+06,-2.756513e+06,
     + -2.721483e+06,-2.720415e+06,-2.752316e+06,-2.810585e+06,
     + -2.885859e+06,-2.955693e+06,-2.892843e+06,-2.089168e+06,
     + -7.587575e+05,-4.099085e+05,-3.310284e+05,-2.945553e+05,
     + -2.686370e+05,-2.490123e+05,-2.324866e+05,-2.194828e+05,
     + -2.076666e+05,-1.973142e+05,-1.879984e+05,-1.808913e+05,
     + -1.728854e+05,-1.639045e+05,-1.613861e+05,-1.566594e+05,
     + -1.530446e+05,-1.530446e+05,-1.478325e+05,-1.458695e+05,
     + -1.458695e+05,-1.430167e+05,-1.407915e+05,-1.407915e+05,
     + -1.391121e+05,-1.374625e+05,-1.374625e+05,-1.362377e+05,
     + -1.352680e+05,-1.352680e+05,-1.340920e+05,-1.338160e+05,
     + -1.335986e+05,-1.328529e+05,-1.328529e+05,-1.322362e+05,
     + -1.322129e+05,-1.317987e+05,-1.316963e+05,-1.315009e+05,
     + -1.313138e+05,-1.311644e+05,-1.310136e+05,-1.308643e+05,
     + -1.306777e+05,-1.304833e+05,-1.303812e+05,-1.299703e+05,
     + -1.299469e+05,-1.293382e+05,-1.293382e+05,-1.286047e+05,
     + -1.283931e+05,-1.281201e+05,-1.269826e+05,-1.269826e+05,
     + -1.260434e+05,-1.248830e+05,-1.248830e+05,-1.233134e+05,
     + -1.217692e+05,-1.217692e+05,-1.196946e+05,-1.171774e+05,
     + -1.171774e+05,-1.153521e+05,-1.109885e+05,-1.109885e+05,
     + -1.078359e+05,-1.041880e+05,-1.019820e+05,-9.532458e+04,
     + -8.940331e+04,-8.447851e+04,-7.840906e+04,-7.198065e+04,
     + -6.505628e+04,-5.779901e+04,-4.855335e+04,-3.874004e+04,
     + -2.673743e+04,-1.233213e+04, 7.219669e+03, 3.332563e+04,
     +  7.266927e+04, 1.312536e+05, 2.227818e+05, 3.596380e+05,
     +  5.272011e+05, 7.170197e+05, 9.006713e+05, 1.060115e+06,
     +  1.202975e+06, 1.335677e+06, 1.467907e+06, 1.604094e+06,
     +  1.750544e+06, 1.909582e+06, 2.079730e+06, 2.263175e+06,
     +  2.463497e+06/)
      B12=(/ 0.000000e+00,-8.021213e+05,-8.021213e+05,-7.895682e+05,
     + -7.465209e+05,-6.997429e+05,-6.531976e+05,-6.027031e+05,
     + -5.533187e+05,-4.997384e+05,-4.462750e+05,-3.894439e+05,
     + -3.331118e+05,-2.773326e+05,-2.228534e+05,-1.731056e+05,
     + -1.310766e+05,-9.291364e+04,-6.317204e+04,-3.999817e+04,
     + -2.262833e+04,-1.015098e+04,-1.730058e+03, 3.806061e+03,
     +  7.237181e+03, 9.245993e+03, 1.003287e+04, 1.021069e+04,
     +  9.938434e+03, 9.353333e+03, 8.555798e+03, 7.770279e+03,
     +  6.707558e+03, 5.392749e+03, 4.902285e+03, 4.158259e+03,
     +  3.410441e+03, 3.410441e+03, 2.500245e+03, 2.018821e+03,
     +  2.018821e+03, 1.508267e+03, 9.801854e+02, 9.801854e+02,
     +  6.725370e+02, 2.781513e+02, 2.781513e+02, 4.519891e+01,
     + -1.926024e+02,-1.926024e+02,-4.283146e+02,-5.072102e+02,
     + -5.444214e+02,-7.171416e+02,-7.171416e+02,-8.475922e+02,
     + -8.571542e+02,-9.446994e+02,-9.690004e+02,-1.012739e+03,
     + -1.054238e+03,-1.087430e+03,-1.120615e+03,-1.153829e+03,
     + -1.195313e+03,-1.239060e+03,-1.263365e+03,-1.350856e+03,
     + -1.360424e+03,-1.490751e+03,-1.490751e+03,-1.663398e+03,
     + -1.700531e+03,-1.779458e+03,-2.014679e+03,-2.014679e+03,
     + -2.252315e+03,-2.484424e+03,-2.484424e+03,-2.878339e+03,
     + -3.184180e+03,-3.184180e+03,-3.711513e+03,-4.217593e+03,
     + -4.217593e+03,-4.699435e+03,-5.598787e+03,-5.598787e+03,
     + -6.344644e+03,-7.074420e+03,-7.565336e+03,-8.854406e+03,
     + -9.897657e+03,-1.066068e+04,-1.142477e+04,-1.197032e+04,
     + -1.219465e+04,-1.196295e+04,-1.109304e+04,-9.023090e+03,
     + -5.458126e+03, 2.005746e+02, 8.745985e+03, 2.158671e+04,
     +  3.886975e+04, 6.257269e+04, 9.261894e+04, 1.309391e+05,
     +  1.735808e+05, 2.234503e+05, 2.768773e+05, 3.332623e+05,
     +  3.915881e+05, 4.460235e+05, 5.015871e+05, 5.521446e+05,
     +  6.044782e+05, 6.526691e+05, 7.005835e+05, 7.458521e+05,
     +  7.923872e+05/)
      B22=(/ 0.000000e+00,-2.806967e+06,-2.806967e+06,-2.775797e+06,
     + -2.672300e+06,-2.567206e+06,-2.470408e+06,-2.373702e+06,
     + -2.286932e+06,-2.200278e+06,-2.119751e+06,-2.037765e+06,
     + -1.956570e+06,-1.872082e+06,-1.780122e+06,-1.682343e+06,
     + -1.582108e+06,-1.469359e+06,-1.357136e+06,-1.244146e+06,
     + -1.132110e+06,-1.023860e+06,-9.230398e+05,-8.292215e+05,
     + -7.432097e+05,-6.581034e+05,-5.903567e+05,-5.267610e+05,
     + -4.665284e+05,-4.117766e+05,-3.607130e+05,-3.204827e+05,
     + -2.724208e+05,-2.196612e+05,-2.007385e+05,-1.742933e+05,
     + -1.477134e+05,-1.477134e+05,-1.170021e+05,-1.007582e+05,
     + -1.007582e+05,-8.402700e+04,-6.672139e+04,-6.672139e+04,
     + -5.677537e+04,-4.402520e+04,-4.402520e+04,-3.653718e+04,
     + -2.889330e+04,-2.889330e+04,-2.133502e+04,-1.880518e+04,
     + -1.761309e+04,-1.207984e+04,-1.207984e+04,-7.902480e+03,
     + -7.596280e+03,-4.793964e+03,-4.015691e+03,-2.614665e+03,
     + -1.286265e+03,-2.234855e+02, 8.391989e+02, 1.901987e+03,
     +  3.230318e+03, 4.631410e+03, 5.409838e+03, 8.211785e+03,
     +  8.518423e+03, 1.269492e+04, 1.269492e+04, 1.822917e+04,
     +  1.941949e+04, 2.195353e+04, 2.950562e+04, 2.950562e+04,
     +  3.715840e+04, 4.463316e+04, 4.463316e+04, 5.740395e+04,
     +  6.731940e+04, 6.731940e+04, 8.467630e+04, 1.013336e+05,
     +  1.013336e+05, 1.176986e+05, 1.482434e+05, 1.482434e+05,
     +  1.750094e+05, 2.011983e+05, 2.203947e+05, 2.729365e+05,
     +  3.211504e+05, 3.613767e+05, 4.123420e+05, 4.670136e+05,
     +  5.270741e+05, 5.904617e+05, 6.589537e+05, 7.427928e+05,
     +  8.295541e+05, 9.230921e+05, 1.023552e+06, 1.133030e+06,
     +  1.243085e+06, 1.357545e+06, 1.469658e+06, 1.581963e+06,
     +  1.682898e+06, 1.780370e+06, 1.870418e+06, 1.955824e+06,
     +  2.039779e+06, 2.118344e+06, 2.202169e+06, 2.284031e+06,
     +  2.376175e+06, 2.468700e+06, 2.568563e+06, 2.670348e+06,
     +  2.782639e+06/)
      B33=(/ 0.000000e+00, 8.971451e+04, 8.910085e+04, 8.406346e+04,
     +  7.545249e+04, 6.845038e+04, 6.280347e+04, 5.821207e+04,
     +  5.455939e+04, 5.165763e+04, 4.931685e+04, 4.746003e+04,
     +  4.598087e+04, 4.482018e+04, 4.390111e+04, 4.318508e+04,
     +  4.263292e+04, 4.217248e+04, 4.182273e+04, 4.154395e+04,
     +  4.132844e+04, 4.115612e+04, 4.102437e+04, 4.091678e+04,
     +  4.083296e+04, 4.076989e+04, 4.071991e+04, 4.068178e+04,
     +  4.065005e+04, 4.062431e+04, 4.060381e+04, 4.058983e+04,
     +  4.057567e+04, 4.056207e+04, 4.055831e+04, 4.055301e+04,
     +  4.054879e+04, 4.054879e+04, 4.054459e+04, 4.054295e+04,
     +  4.054295e+04, 4.054127e+04, 4.053993e+04, 4.053993e+04,
     +  4.053932e+04, 4.053872e+04, 4.053872e+04, 4.053841e+04,
     +  4.053817e+04, 4.053817e+04, 4.053798e+04, 4.053794e+04,
     +  4.053789e+04, 4.053775e+04, 4.053775e+04, 4.053774e+04,
     +  4.053774e+04, 4.053772e+04, 4.053772e+04, 4.053773e+04,
     +  4.053771e+04, 4.053770e+04, 4.053770e+04, 4.053770e+04,
     +  4.053768e+04, 4.053775e+04, 4.053778e+04, 4.053775e+04,
     +  4.053775e+04, 4.053775e+04, 4.053775e+04, 4.053789e+04,
     +  4.053794e+04, 4.053797e+04, 4.053810e+04, 4.053810e+04,
     +  4.053835e+04, 4.053865e+04, 4.053865e+04, 4.053936e+04,
     +  4.054007e+04, 4.054007e+04, 4.054132e+04, 4.054288e+04,
     +  4.054288e+04, 4.054456e+04, 4.054885e+04, 4.054885e+04,
     +  4.055301e+04, 4.055823e+04, 4.056201e+04, 4.057571e+04,
     +  4.058991e+04, 4.060375e+04, 4.062440e+04, 4.064974e+04,
     +  4.068177e+04, 4.071998e+04, 4.076991e+04, 4.083281e+04,
     +  4.091683e+04, 4.102460e+04, 4.115602e+04, 4.132841e+04,
     +  4.154376e+04, 4.182305e+04, 4.217226e+04, 4.263310e+04,
     +  4.318513e+04, 4.390104e+04, 4.481986e+04, 4.598123e+04,
     +  4.745988e+04, 4.931723e+04, 5.165746e+04, 5.455915e+04,
     +  5.821223e+04, 6.280356e+04, 6.845032e+04, 7.545227e+04,
     +  8.431980e+04/)
      C11=(/ 0.000000e+00,-4.273689e+06,-4.273689e+06,-4.136314e+06,
     + -3.845770e+06,-3.457347e+06,-2.846542e+06,-1.761048e+06,
     +  2.925464e+05, 3.547767e+06, 7.017892e+06, 9.196538e+06,
     +  1.019140e+07, 1.074258e+07, 1.108213e+07, 1.132048e+07,
     +  1.149061e+07, 1.162557e+07, 1.174028e+07, 1.184040e+07,
     +  1.193306e+07, 1.201585e+07, 1.209513e+07, 1.216910e+07,
     +  1.223933e+07, 1.231004e+07, 1.237541e+07, 1.245009e+07,
     +  1.251172e+07, 1.257746e+07, 1.264964e+07, 1.271364e+07,
     +  1.277793e+07, 1.283921e+07, 1.291293e+07, 1.297801e+07,
     +  1.302309e+07, 1.309465e+07, 1.314679e+07, 1.320128e+07,
     +  1.323458e+07, 1.332038e+07, 1.334347e+07, 1.343684e+07,
     +  1.343684e+07, 1.345846e+07, 1.352827e+07, 1.352827e+07,
     +  1.354676e+07, 1.359271e+07, 1.359271e+07, 1.361892e+07,
     +  1.363723e+07, 1.364361e+07, 1.366762e+07, 1.367125e+07,
     +  1.368818e+07, 1.369530e+07, 1.370396e+07, 1.371271e+07,
     +  1.371962e+07, 1.372504e+07, 1.374354e+07, 1.374354e+07,
     +  1.374354e+07, 1.374354e+07, 1.374800e+07, 1.377754e+07,
     +  1.377754e+07, 1.378339e+07, 1.382093e+07, 1.382093e+07,
     +  1.382093e+07, 1.387970e+07, 1.388774e+07, 1.388774e+07,
     +  1.392990e+07, 1.399161e+07, 1.399161e+07, 1.399161e+07,
     +  1.410461e+07, 1.415343e+07, 1.415343e+07, 1.431890e+07,
     +  1.435293e+07, 1.435293e+07, 1.451899e+07, 1.455487e+07,
     +  1.461224e+07, 1.475191e+07, 1.475191e+07, 1.493106e+07,
     +  1.493576e+07, 1.505927e+07, 1.509827e+07, 1.516861e+07,
     +  1.523207e+07, 1.525108e+07, 1.533219e+07, 1.533219e+07,
     +  1.538018e+07, 1.539636e+07, 1.540405e+07, 1.542832e+07,
     +  1.542832e+07, 1.543630e+07, 1.543723e+07, 1.543337e+07,
     +  1.543179e+07, 1.542069e+07, 1.541149e+07, 1.540007e+07,
     +  1.538493e+07, 1.536623e+07, 1.534439e+07, 1.532049e+07,
     +  1.529490e+07, 1.526476e+07, 1.523094e+07, 1.519217e+07,
     +  1.514556e+07/)
      C21=(/ 0.000000e+00,-4.282621e+05,-4.282621e+05,-4.438849e+05,
     + -4.818000e+05,-5.346745e+05,-6.093891e+05,-7.209435e+05,
     + -9.218776e+05,-1.423426e+06,-9.351652e+05,-7.564055e+04,
     + -1.203345e+03, 9.078098e+03, 9.719024e+03, 8.641090e+03,
     +  7.481854e+03, 6.489627e+03, 5.657574e+03, 4.960657e+03,
     +  4.346549e+03, 3.825151e+03, 3.353262e+03, 2.943331e+03,
     +  2.589003e+03, 2.273301e+03, 2.022759e+03, 1.794402e+03,
     +  1.653779e+03, 1.550649e+03, 1.493012e+03, 1.487861e+03,
     +  1.520193e+03, 1.580684e+03, 1.689961e+03, 1.817008e+03,
     +  1.914434e+03, 2.082196e+03, 2.220013e+03, 2.364062e+03,
     +  2.458446e+03, 2.701629e+03, 2.768788e+03, 3.040423e+03,
     +  3.040423e+03, 3.103008e+03, 3.305145e+03, 3.305145e+03,
     +  3.357686e+03, 3.488280e+03, 3.488280e+03, 3.561322e+03,
     +  3.612328e+03, 3.629793e+03, 3.695583e+03, 3.705413e+03,
     +  3.751198e+03, 3.770271e+03, 3.793423e+03, 3.816703e+03,
     +  3.835006e+03, 3.849292e+03, 3.897643e+03, 3.897643e+03,
     +  3.897643e+03, 3.897643e+03, 3.909128e+03, 3.985172e+03,
     +  3.985172e+03, 3.999815e+03, 4.093801e+03, 4.093801e+03,
     +  4.093801e+03, 4.234624e+03, 4.253885e+03, 4.253885e+03,
     +  4.347272e+03, 4.483938e+03, 4.483938e+03, 4.483938e+03,
     +  4.698635e+03, 4.791393e+03, 4.791393e+03, 5.029767e+03,
     +  5.078793e+03, 5.078793e+03, 5.222730e+03, 5.253831e+03,
     +  5.267934e+03, 5.302266e+03, 5.302266e+03, 5.231531e+03,
     +  5.229675e+03, 5.102745e+03, 5.062666e+03, 4.947643e+03,
     +  4.843870e+03, 4.801737e+03, 4.621978e+03, 4.621978e+03,
     +  4.483943e+03, 4.437420e+03, 4.406455e+03, 4.308783e+03,
     +  4.308783e+03, 4.237499e+03, 4.229250e+03, 4.189623e+03,
     +  4.179607e+03, 4.151929e+03, 4.140612e+03, 4.128811e+03,
     +  4.117747e+03, 4.108095e+03, 4.099794e+03, 4.092712e+03,
     +  4.086625e+03, 4.080689e+03, 4.074933e+03, 4.069329e+03,
     +  4.063273e+03/)
      C12=(/ 0.000000e+00, 1.152203e+05, 1.152203e+05, 1.679014e+05,
     +  2.867786e+05, 4.137859e+05, 5.446026e+05, 6.781808e+05,
     +  8.117355e+05, 9.562728e+05, 1.122471e+06, 1.315771e+06,
     +  1.557854e+06, 1.858727e+06, 2.335081e+06, 4.896996e+06,
     +  2.963041e+06,-9.337778e+05,-8.276305e+04,-1.023880e+05,
     +  3.176121e+05,-1.108141e+06, 1.226572e+06,-2.081792e+06,
     +  1.297189e+06,-9.858187e+05,-6.552439e+05, 6.620287e+06,
     +  3.180803e+05, 2.455334e+05, 1.848620e+05, 1.373511e+05,
     +  9.611249e+04, 6.832702e+04, 4.663212e+04, 3.014732e+04,
     +  1.876711e+04, 1.158036e+04, 5.735242e+03, 2.265869e+03,
     +  8.656516e+02,-2.597060e+01,-3.397627e+02, 1.474325e+03,
     +  1.474325e+03, 1.512167e+03, 4.602135e+03, 4.602135e+03,
     +  5.038407e+03, 7.519921e+03, 7.519921e+03, 8.691765e+03,
     +  9.830075e+03, 1.011115e+04, 1.153029e+04, 1.171499e+04,
     +  1.273424e+04, 1.315292e+04, 1.368335e+04, 1.422259e+04,
     +  1.465278e+04, 1.499250e+04, 1.520350e+04, 1.554886e+04,
     +  1.599483e+04, 1.656553e+04, 1.712550e+04, 1.764892e+04,
     +  1.874110e+04, 1.911103e+04, 2.058930e+04, 2.140450e+04,
     +  2.192779e+04, 2.506638e+04, 2.506638e+04, 2.660753e+04,
     +  3.104319e+04, 3.104319e+04, 3.113784e+04, 4.103966e+04,
     +  4.103966e+04, 4.446340e+04, 5.660239e+04, 5.660239e+04,
     +  5.660239e+04, 7.382465e+04, 7.609393e+04, 7.619151e+04,
     +  9.709077e+04, 9.709077e+04, 1.093632e+05, 1.188713e+05,
     +  1.256350e+05, 1.406020e+05, 1.447036e+05, 1.614541e+05,
     +  1.643454e+05, 1.806299e+05, 1.834302e+05, 1.974620e+05,
     +  2.004260e+05, 2.115404e+05, 2.156443e+05, 2.228251e+05,
     +  2.282224e+05, 2.316430e+05, 2.384241e+05, 2.413217e+05,
     +  2.448868e+05, 2.486398e+05, 2.525477e+05, 2.558526e+05,
     +  2.594342e+05, 2.631162e+05, 2.666871e+05, 2.706895e+05,
     +  2.747528e+05, 2.794205e+05, 2.841870e+05, 2.895212e+05,
     +  2.956505e+05/)
      C22=(/ 0.000000e+00,-5.105019e+05,-5.105019e+05,-5.352501e+05,
     + -5.875158e+05,-6.405653e+05,-6.955629e+05,-7.529444e+05,
     + -8.079799e+05,-8.552288e+05,-8.772978e+05,-8.410061e+05,
     + -6.838764e+05,-3.016791e+05, 5.648164e+05, 4.269675e+06,
     +  2.192805e+06,-4.165404e+06, 2.414528e+06,-5.123137e+06,
     +  6.284026e+06,-2.668812e+06,-1.105927e+07, 1.484163e+07,
     + -1.349671e+06,-3.826792e+06, 1.424250e+06,-1.530470e+07,
     +  9.148154e+05, 8.729261e+05, 8.292168e+05, 7.870993e+05,
     +  7.410462e+05, 7.021554e+05, 6.644020e+05, 6.280169e+05,
     +  5.953534e+05, 5.689206e+05, 5.419164e+05, 5.134156e+05,
     +  5.019129e+05, 4.728393e+05, 4.596696e+05, 4.238108e+05,
     +  4.238108e+05, 4.234841e+05, 3.968056e+05, 3.968056e+05,
     +  3.941047e+05, 3.787419e+05, 3.787419e+05, 3.726307e+05,
     +  3.666944e+05, 3.653673e+05, 3.586672e+05, 3.578469e+05,
     +  3.533199e+05, 3.515309e+05, 3.492766e+05, 3.470348e+05,
     +  3.452766e+05, 3.439051e+05, 3.430612e+05, 3.416937e+05,
     +  3.399483e+05, 3.377497e+05, 3.356340e+05, 3.336674e+05,
     +  3.296956e+05, 3.283504e+05, 3.232217e+05, 3.203935e+05,
     +  3.186951e+05, 3.085084e+05, 3.085084e+05, 3.039474e+05,
     +  2.908200e+05, 2.908200e+05, 2.905726e+05, 2.646948e+05,
     +  2.646948e+05, 2.570165e+05, 2.297929e+05, 2.297929e+05,
     +  2.297929e+05, 1.969179e+05, 1.925862e+05, 1.924265e+05,
     +  1.582248e+05, 1.582248e+05, 1.407563e+05, 1.272225e+05,
     +  1.187783e+05, 1.000925e+05, 9.558006e+04, 7.715221e+04,
     +  7.434729e+04, 5.854926e+04, 5.616148e+04, 4.419698e+04,
     +  4.199349e+04, 3.373096e+04, 3.110839e+04, 2.651961e+04,
     +  2.361796e+04, 2.177899e+04, 1.879700e+04, 1.777713e+04,
     +  1.660258e+04, 1.559830e+04, 1.480977e+04, 1.431719e+04,
     +  1.392258e+04, 1.364039e+04, 1.345148e+04, 1.330918e+04,
     +  1.321303e+04, 1.314224e+04, 1.309381e+04, 1.305610e+04,
     +  1.302160e+04/)
      C33=(/ 0.000000e+00, 5.443969e+05, 5.450689e+05, 5.505309e+05,
     +  5.602227e+05, 5.707379e+05, 5.822156e+05, 5.945805e+05,
     +  6.076647e+05, 6.215993e+05, 6.360450e+05, 6.505584e+05,
     +  6.649428e+05, 6.788295e+05, 6.918850e+05, 7.037224e+05,
     +  7.137407e+05, 7.218657e+05, 7.283321e+05, 7.331954e+05,
     +  7.366275e+05, 7.389835e+05, 7.405253e+05, 7.414249e+05,
     +  7.419625e+05, 7.422728e+05, 7.424190e+05, 7.424781e+05,
     +  7.424890e+05, 7.424734e+05, 7.424510e+05, 7.424275e+05,
     +  7.424071e+05, 7.423923e+05, 7.423835e+05, 7.423783e+05,
     +  7.423804e+05, 7.423811e+05, 7.423964e+05, 7.423970e+05,
     +  7.424171e+05, 7.424269e+05, 7.424405e+05, 7.424670e+05,
     +  7.424670e+05, 7.424835e+05, 7.425042e+05, 7.425042e+05,
     +  7.425166e+05, 7.425335e+05, 7.425335e+05, 7.425478e+05,
     +  7.425548e+05, 7.425587e+05, 7.425698e+05, 7.425719e+05,
     +  7.425803e+05, 7.425840e+05, 7.425884e+05, 7.425929e+05,
     +  7.425965e+05, 7.425994e+05, 7.426012e+05, 7.426040e+05,
     +  7.426077e+05, 7.426124e+05, 7.426172e+05, 7.426213e+05,
     +  7.426308e+05, 7.426332e+05, 7.426469e+05, 7.426516e+05,
     +  7.426610e+05, 7.426805e+05, 7.426805e+05, 7.427071e+05,
     +  7.427267e+05, 7.427267e+05, 7.427689e+05, 7.428026e+05,
     +  7.428026e+05, 7.428801e+05, 7.429196e+05, 7.429685e+05,
     +  7.430686e+05, 7.430751e+05, 7.432334e+05, 7.432784e+05,
     +  7.434137e+05, 7.435611e+05, 7.437061e+05, 7.438908e+05,
     +  7.441078e+05, 7.443540e+05, 7.446226e+05, 7.449745e+05,
     +  7.453040e+05, 7.456744e+05, 7.460364e+05, 7.463561e+05,
     +  7.465502e+05, 7.465284e+05, 7.461160e+05, 7.451063e+05,
     +  7.432596e+05, 7.402659e+05, 7.359171e+05, 7.301069e+05,
     +  7.226058e+05, 7.134211e+05, 7.029950e+05, 6.916374e+05,
     +  6.796338e+05, 6.673093e+05, 6.548567e+05, 6.426919e+05,
     +  6.311573e+05, 6.201945e+05, 6.100297e+05, 6.008551e+05,
     +  5.919999e+05/)
      D11=(/ 0.000000e+00, 8.315583e+04, 8.300027e+04, 7.950406e+04,
     +  7.049456e+04, 5.952668e+04, 4.761361e+04, 3.548610e+04,
     +  2.397140e+04, 1.351148e+04, 4.156680e+03,-3.860820e+03,
     + -1.053888e+04,-1.567994e+04,-1.905893e+04,-1.997508e+04,
     + -1.628923e+04,-1.045955e+02, 6.481967e+04, 3.771680e+05,
     +  8.673021e+05, 1.001485e+06, 1.031382e+06, 1.043982e+06,
     +  1.052324e+06, 1.058428e+06, 1.063512e+06, 1.067521e+06,
     +  1.071193e+06, 1.074451e+06, 1.077425e+06, 1.079730e+06,
     +  1.082361e+06, 1.085367e+06, 1.086215e+06, 1.087840e+06,
     +  1.089082e+06, 1.089082e+06, 1.090911e+06, 1.091599e+06,
     +  1.091599e+06, 1.092618e+06, 1.093412e+06, 1.093412e+06,
     +  1.094019e+06, 1.094615e+06, 1.094615e+06, 1.095062e+06,
     +  1.095415e+06, 1.095415e+06, 1.095846e+06, 1.095948e+06,
     +  1.096028e+06, 1.096302e+06, 1.096302e+06, 1.096529e+06,
     +  1.096538e+06, 1.096691e+06, 1.096729e+06, 1.096801e+06,
     +  1.096870e+06, 1.096926e+06, 1.096982e+06, 1.097037e+06,
     +  1.097106e+06, 1.097179e+06, 1.097216e+06, 1.097369e+06,
     +  1.097378e+06, 1.097604e+06, 1.097604e+06, 1.097878e+06,
     +  1.097957e+06, 1.098060e+06, 1.098486e+06, 1.098486e+06,
     +  1.098840e+06, 1.099277e+06, 1.099277e+06, 1.099874e+06,
     +  1.100461e+06, 1.100461e+06, 1.101260e+06, 1.102230e+06,
     +  1.102230e+06, 1.102946e+06, 1.104657e+06, 1.104657e+06,
     +  1.105921e+06, 1.107383e+06, 1.108288e+06, 1.111038e+06,
     +  1.113534e+06, 1.115642e+06, 1.118283e+06, 1.121123e+06,
     +  1.124213e+06, 1.127468e+06, 1.131591e+06, 1.135866e+06,
     +  1.140846e+06, 1.146319e+06, 1.152764e+06, 1.159799e+06,
     +  1.168011e+06, 1.177158e+06, 1.187912e+06, 1.200631e+06,
     +  1.214420e+06, 1.230199e+06, 1.247521e+06, 1.265798e+06,
     +  1.285396e+06, 1.306103e+06, 1.328087e+06, 1.351106e+06,
     +  1.375516e+06, 1.401149e+06, 1.427305e+06, 1.453865e+06,
     +  1.480800e+06/)
      D21=(/ 0.000000e+00, 1.967212e+03, 1.982253e+03, 2.233332e+03,
     +  2.701323e+03, 3.143368e+03, 3.550507e+03, 3.907850e+03,
     +  4.193130e+03, 4.395665e+03, 4.513233e+03, 4.546362e+03,
     +  4.502368e+03, 4.399686e+03, 4.256773e+03, 4.104783e+03,
     +  3.981801e+03, 3.950000e+03, 4.160810e+03, 4.312148e+03,
     +  2.638886e+03, 1.545400e+03, 1.198655e+03, 1.059492e+03,
     +  9.816685e+02, 9.327952e+02, 8.958009e+02, 8.679402e+02,
     +  8.426511e+02, 8.199411e+02, 7.986313e+02, 7.815110e+02,
     +  7.613125e+02, 7.372108e+02, 7.303061e+02, 7.163761e+02,
     +  7.057229e+02, 7.057229e+02, 6.892622e+02, 6.830629e+02,
     +  6.830629e+02, 6.735150e+02, 6.660677e+02, 6.660677e+02,
     +  6.602084e+02, 6.544532e+02, 6.544532e+02, 6.500597e+02,
     +  6.465812e+02, 6.465812e+02, 6.422838e+02, 6.412753e+02,
     +  6.404709e+02, 6.377121e+02, 6.377121e+02, 6.354116e+02,
     +  6.353250e+02, 6.337712e+02, 6.333858e+02, 6.326506e+02,
     +  6.319447e+02, 6.313795e+02, 6.308087e+02, 6.302425e+02,
     +  6.295338e+02, 6.287934e+02, 6.284046e+02, 6.268343e+02,
     +  6.267443e+02, 6.244050e+02, 6.244050e+02, 6.215636e+02,
     +  6.207436e+02, 6.196730e+02, 6.152118e+02, 6.152118e+02,
     +  6.114601e+02, 6.068247e+02, 6.068247e+02, 6.003811e+02,
     +  5.940417e+02, 5.940417e+02, 5.851721e+02, 5.744106e+02,
     +  5.744106e+02, 5.661562e+02, 5.464229e+02, 5.464229e+02,
     +  5.311867e+02, 5.135570e+02, 5.021339e+02, 4.668660e+02,
     +  4.335048e+02, 4.043925e+02, 3.664883e+02, 3.241318e+02,
     +  2.762215e+02, 2.239310e+02, 1.551092e+02, 8.118115e+01,
     + -7.323509e+00,-1.062012e+02,-2.217482e+02,-3.416619e+02,
     + -4.642922e+02,-5.656018e+02,-6.232090e+02,-6.067698e+02,
     + -5.268082e+02,-4.316088e+02,-3.859147e+02,-4.165176e+02,
     + -5.062747e+02,-6.324088e+02,-7.800185e+02,-9.418581e+02,
     + -1.120517e+03,-1.317646e+03,-1.530790e+03,-1.761171e+03,
     + -2.010418e+03/)
      D12=(/ 0.000000e+00,-2.734793e+02,-2.734793e+02,-2.357151e+02,
     + -1.044953e+02, 4.080517e+01, 1.864846e+02, 3.436439e+02,
     +  4.943829e+02, 6.522628e+02, 8.015549e+02, 9.487358e+02,
     +  1.080165e+03, 1.193908e+03, 1.285042e+03, 1.347564e+03,
     +  1.379138e+03, 1.385216e+03, 1.366965e+03, 1.330169e+03,
     +  1.279396e+03, 1.219968e+03, 1.157233e+03, 1.093713e+03,
     +  1.031879e+03, 9.677075e+02, 9.148850e+02, 8.640975e+02,
     +  8.150491e+02, 7.697315e+02, 7.269144e+02, 6.928314e+02,
     +  6.518305e+02, 6.064785e+02, 5.901684e+02, 5.672304e+02,
     +  5.441755e+02, 5.441755e+02, 5.174205e+02, 5.032692e+02,
     +  5.032692e+02, 4.886525e+02, 4.735340e+02, 4.735340e+02,
     +  4.648317e+02, 4.536758e+02, 4.536758e+02, 4.471191e+02,
     +  4.404259e+02, 4.404259e+02, 4.338050e+02, 4.315889e+02,
     +  4.305445e+02, 4.256969e+02, 4.256969e+02, 4.220361e+02,
     +  4.217677e+02, 4.193118e+02, 4.186298e+02, 4.174019e+02,
     +  4.162379e+02, 4.153062e+02, 4.143756e+02, 4.134436e+02,
     +  4.122788e+02, 4.110515e+02, 4.103695e+02, 4.079128e+02,
     +  4.076441e+02, 4.039838e+02, 4.039838e+02, 3.991324e+02,
     +  3.980890e+02, 3.958676e+02, 3.892475e+02, 3.892475e+02,
     +  3.825396e+02, 3.759876e+02, 3.759876e+02, 3.647958e+02,
     +  3.561063e+02, 3.561063e+02, 3.409070e+02, 3.263204e+02,
     +  3.263204e+02, 3.120153e+02, 2.853151e+02, 2.853151e+02,
     +  2.619960e+02, 2.391796e+02, 2.225466e+02, 1.771398e+02,
     +  1.357823e+02, 1.015217e+02, 5.859614e+01, 1.322356e+01,
     + -3.566188e+01,-8.601103e+01,-1.387067e+02,-2.003196e+02,
     + -2.597936e+02,-3.181547e+02,-3.725956e+02,-4.194598e+02,
     + -4.502033e+02,-4.593681e+02,-4.394488e+02,-3.824523e+02,
     + -2.919282e+02,-1.599981e+02, 2.438127e+00, 1.913049e+02,
     +  3.988049e+02, 5.984319e+02, 8.032460e+02, 9.868834e+02,
     +  1.171084e+03, 1.333433e+03, 1.486709e+03, 1.623480e+03,
     +  1.755563e+03/)
      D22=(/ 0.000000e+00, 2.646347e+04, 2.646347e+04, 2.588662e+04,
     +  2.400521e+04, 2.215470e+04, 2.049377e+04, 1.886172e+04,
     +  1.740939e+04, 1.596249e+04, 1.462272e+04, 1.327926e+04,
     +  1.199912e+04, 1.075165e+04, 9.523444e+03, 8.365713e+03,
     +  7.331882e+03, 6.321136e+03, 5.453451e+03, 4.696419e+03,
     +  4.046664e+03, 3.501011e+03, 3.058382e+03, 2.697651e+03,
     +  2.406822e+03, 2.156242e+03, 1.980965e+03, 1.834983e+03,
     +  1.712918e+03, 1.615869e+03, 1.537154e+03, 1.483600e+03,
     +  1.427385e+03, 1.376274e+03, 1.359382e+03, 1.341398e+03,
     +  1.323322e+03, 1.323322e+03, 1.308424e+03, 1.300544e+03,
     +  1.300544e+03, 1.295109e+03, 1.289487e+03, 1.289487e+03,
     +  1.287388e+03, 1.284697e+03, 1.284697e+03, 1.283684e+03,
     +  1.282650e+03, 1.282650e+03, 1.282010e+03, 1.281795e+03,
     +  1.281735e+03, 1.281452e+03, 1.281452e+03, 1.281332e+03,
     +  1.281323e+03, 1.281285e+03, 1.281280e+03, 1.281275e+03,
     +  1.281279e+03, 1.281287e+03, 1.281300e+03, 1.281317e+03,
     +  1.281345e+03, 1.281384e+03, 1.281408e+03, 1.281513e+03,
     +  1.281529e+03, 1.281750e+03, 1.281750e+03, 1.282165e+03,
     +  1.282255e+03, 1.282530e+03, 1.283352e+03, 1.283352e+03,
     +  1.284571e+03, 1.285762e+03, 1.285762e+03, 1.288764e+03,
     +  1.291094e+03, 1.291094e+03, 1.297148e+03, 1.302959e+03,
     +  1.302959e+03, 1.311287e+03, 1.326832e+03, 1.326832e+03,
     +  1.345670e+03, 1.364101e+03, 1.381688e+03, 1.433864e+03,
     +  1.491449e+03, 1.546032e+03, 1.625870e+03, 1.724125e+03,
     +  1.847277e+03, 1.994247e+03, 2.173290e+03, 2.422088e+03,
     +  2.717388e+03, 3.079454e+03, 3.522833e+03, 4.077862e+03,
     +  4.718877e+03, 5.488221e+03, 6.359066e+03, 7.369215e+03,
     +  8.414092e+03, 9.571782e+03, 1.077515e+04, 1.203573e+04,
     +  1.336291e+04, 1.465280e+04, 1.604913e+04, 1.741766e+04,
     +  1.896182e+04, 2.052500e+04, 2.224075e+04, 2.403433e+04,
     +  2.608084e+04/)
      D33=(/ 0.000000e+00, 5.218421e+04, 5.209473e+04, 5.137372e+04,
     +  5.013916e+04, 4.912943e+04, 4.830498e+04, 4.762173e+04,
     +  4.706408e+04, 4.660679e+04, 4.622388e+04, 4.590681e+04,
     +  4.564156e+04, 4.542203e+04, 4.523757e+04, 4.508485e+04,
     +  4.495877e+04, 4.484600e+04, 4.475372e+04, 4.467388e+04,
     +  4.460705e+04, 4.454867e+04, 4.450002e+04, 4.445647e+04,
     +  4.441880e+04, 4.438770e+04, 4.436050e+04, 4.433757e+04,
     +  4.431633e+04, 4.429741e+04, 4.428021e+04, 4.426687e+04,
     +  4.425157e+04, 4.423435e+04, 4.422930e+04, 4.422017e+04,
     +  4.421291e+04, 4.421291e+04, 4.420266e+04, 4.419865e+04,
     +  4.419865e+04, 4.419297e+04, 4.418844e+04, 4.418844e+04,
     +  4.418507e+04, 4.418172e+04, 4.418172e+04, 4.417923e+04,
     +  4.417724e+04, 4.417724e+04, 4.417484e+04, 4.417427e+04,
     +  4.417383e+04, 4.417230e+04, 4.417230e+04, 4.417104e+04,
     +  4.417099e+04, 4.417014e+04, 4.416993e+04, 4.416952e+04,
     +  4.416915e+04, 4.416884e+04, 4.416853e+04, 4.416822e+04,
     +  4.416783e+04, 4.416744e+04, 4.416723e+04, 4.416637e+04,
     +  4.416633e+04, 4.416507e+04, 4.416507e+04, 4.416356e+04,
     +  4.416312e+04, 4.416256e+04, 4.416021e+04, 4.416021e+04,
     +  4.415826e+04, 4.415583e+04, 4.415583e+04, 4.415259e+04,
     +  4.414934e+04, 4.414934e+04, 4.414505e+04, 4.413967e+04,
     +  4.413967e+04, 4.413596e+04, 4.412651e+04, 4.412651e+04,
     +  4.412003e+04, 4.411188e+04, 4.410752e+04, 4.409284e+04,
     +  4.408022e+04, 4.406944e+04, 4.405598e+04, 4.404189e+04,
     +  4.402658e+04, 4.401076e+04, 4.399284e+04, 4.397341e+04,
     +  4.395142e+04, 4.392790e+04, 4.390377e+04, 4.387752e+04,
     +  4.385080e+04, 4.382313e+04, 4.379613e+04, 4.376961e+04,
     +  4.374704e+04, 4.372884e+04, 4.371764e+04, 4.371781e+04,
     +  4.373363e+04, 4.377175e+04, 4.383974e+04, 4.394684e+04,
     +  4.410767e+04, 4.434030e+04, 4.466164e+04, 4.510190e+04,
     +  4.571120e+04/)
C
C -------------------- STATE VARIABLE DEFINITION ----------------------
C
      statev(1)=noel;statev(2)=npt;statev(3)=kstep;statev(4)=kinc;
      statev(5)=kit;statev(6)=time(1);statev(7)=dtime;
	  statev(8)=thick;statev(9)=celent;statev(10)=temp; 
	  statev(11)=dtemp;statev(12)=zero;statev(13)=zero
      k3=0
	  p=1
      do k1=1,3
      do k2=1,3
      statev(14+k3)=basis(k1,k2)
      statev(23+k3)=dfgrd(k1,k2)
      k3=k3+1
      end do
      end do
      statev(32)=curv(1,1);statev(33)=curv(1,2);statev(34)=curv(2,1)
      statev(35)=curv(2,2);statev(36)=tss(1);statev(37)=tss(2)
      statev(38)=coords(1);statev(39)=coords(2);statev(40)=coords(3)
      do k1=1,nsecv
      statev(40+k1)=stran(k1)
      end do
      istatev=40+nsecv
C
C ------------- INITIALISING STIFFNESS AND STRAIN ARRAYS --------------
C
      do ii=1,121
      do jj=1,6
      do kk=1,6
      STIF(ii,jj,kk)=0.0e-15
      e(ii,jj,kk)=1.0e-16
      end do
      end do
      end do
C  
C ------------------- ASSEMBLING STIFFNESS MATRIX ---------------------
C
      do m=1,121
      STIF(m,1,1)=A11(m)
      STIF(m,1,2)=A12(m)
      STIF(m,1,4)=B11(m)
      STIF(m,1,5)=B12(m)
	  STIF(m,2,1)=A21(m)
	  STIF(m,2,2)=A22(m)
	  STIF(m,2,4)=B21(m)
	  STIF(m,2,5)=B22(m)
      STIF(m,3,3)=A33(m)
      STIF(m,3,6)=B33(m)
      STIF(m,4,1)=C11(m)
	  STIF(m,4,2)=C12(m)
	  STIF(m,4,4)=D11(m)
	  STIF(m,4,5)=D12(m)
	  STIF(m,5,1)=C21(m)
	  STIF(m,5,2)=C22(m)
      STIF(m,5,4)=D21(m)
	  STIF(m,5,5)=D22(m)
      STIF(m,6,3)=C33(m)
      STIF(m,6,6)=D33(m)
      end do
C
C ----------------- ASSEMBLING STRAIN POINT MATRIX --------------------
C
      do m=1,121
      e(m,1,1)=e1(m)
      e(m,1,2)=e1(m)
      e(m,1,4)=e2(m)
      e(m,1,5)=e2(m)
      e(m,2,1)=e1(m)
      e(m,2,2)=e1(m)
      e(m,2,4)=e2(m)
      e(m,2,5)=e2(m)
      e(m,3,3)=e1(m)
      e(m,3,6)=e2(m)
      e(m,4,1)=e1(m)
      e(m,4,2)=e1(m)
      e(m,4,4)=e2(m)
      e(m,4,5)=e2(m)
      e(m,5,1)=e1(m)
      e(m,5,2)=e1(m)
      e(m,5,4)=e2(m)
      e(m,5,5)=e2(m)
      e(m,6,3)=e1(m)
      e(m,6,6)=e2(m)
      end do
C
C Loop over force(i) and strain(j)
C
      do i=1,6
      do j=1,6
C
C --------- LOCATE NEAREST STRAIN ID IN STRAIN POINT MATRIX -----------
C
C Check current strain ID
C Start ID=62 if tension / 61 if compression
      stranCurrent = stran(j)
      found = .FALSE.
      IF (ABS(stran(j)) < 1.0E-12) THEN
      curr_ID = 62
      ELSE
      DO ii = 2, 121
      IF (e(ii-1,i,j) .LE. stranCurrent .AND. stranCurrent .LT. e(ii,i,j)) THEN
      curr_ID = ii
      found = .TRUE.
      EXIT
      END IF
      END DO

      IF (.NOT. found) THEN
      ! Handle extrapolation
      IF (stranCurrent .LE. e(1,i,j)) THEN
      curr_ID = 2
      ELSE IF (stranCurrent .GE. e(121,i,j)) THEN
      curr_ID = 121
      END IF
      END IF
      END IF
      stranNext = stran(j) + dstran(j)
      found = .FALSE.
      DO jj = 2, 121
      IF (e(jj-1,i,j) .LE. stranNext .AND. stranNext .LT. e(jj,i,j)) THEN
      next_ID = jj
      found = .TRUE.
      EXIT
      END IF
      END DO

      IF (.NOT. found) THEN
      ! Handle extrapolation
      IF (stranNext .LE. e(1,i,j)) THEN
      next_ID = 2
      ELSE IF (stranNext .GE. e(121,i,j)) THEN
      next_ID = 121
      END IF
      END IF
C
C ----------------- UPDATE TANGENT STIFFNESS MATRIX -------------------
C	  
      ddndde(i,j)=STIF(curr_ID,i,j)
C
C Initial tangent stiffness matrix can be used as	  
C      ddndde(i,j)=props(p)
C      p=p+1
C
C ------------------- UPDATE FORCES AND MOMENTS -----------------------
C
      curr_stran_modif=sign(1.0,dstran(j))
      n=next_ID-curr_ID
      IF (SIGN(1.0, stranCurrent) == curr_stran_modif) THEN
      IF (n == 0) THEN
      ! No interval crossed, use local stiffness
      force(i) = force(i) + STIF(curr_ID,i,j) * dstran(j)
      ELSE IF (n > 0) THEN
      ! Tension interpolation
      e_int1 = e(curr_ID,i,j) - stranCurrent
      e_int2 = stranNext - e(curr_ID+n-1,i,j)
      force(i) = force(i) + STIF(curr_ID,i,j) * e_int1
      force(i) = force(i) + STIF(curr_ID+n,i,j) * e_int2
      DO k = 2, n
      idx1 = curr_ID + k - 1
      idx2 = curr_ID + k - 2
      force(i) = force(i) + STIF(idx1,i,j) * (e(idx1,i,j) - e(idx2,i,j))
	  END DO
	  ELSE
      ! Compression interpolation
      e_int1 = e(curr_ID-1,i,j) - stranCurrent
      e_int2 = stranNext - e(curr_ID+n,i,j)

      force(i) = force(i) + STIF(curr_ID,i,j) * e_int1
      force(i) = force(i) + STIF(curr_ID+n,i,j) * e_int2

      DO k = -2, n, -1
      idx1 = curr_ID + k + 1
      idx2 = curr_ID + k
      force(i) = force(i) + STIF(idx1,i,j) * (e(idx2,i,j) - e(idx1,i,j))
	  END DO
      END IF
      END IF

C CASE 2: Increment is in opposite same direction as strain
      IF (SIGN(1.0, stranCurrent) /= SIGN(1.0, dstran(j))) THEN

      IF (n == 0) THEN
      ! No interval crossed, use local stiffness
      force(i) = force(i) + STIF(curr_ID,i,j) * dstran(j)      
	  ELSE IF (n < 0) THEN
      ! Reverse tension interpolation (moving toward compression)
      e_int1 = stranCurrent - e(curr_ID-1,i,j)
      e_int2 = e(curr_ID+n,i,j) - stranNext

      force(i) = force(i) - STIF(curr_ID,i,j) * e_int1
      force(i) = force(i) - STIF(curr_ID+n,i,j) * e_int2
      DO k = -2, n, -1
      idx1 = curr_ID + k + 1
      idx2 = curr_ID + k
      force(i) = force(i) - STIF(idx1,i,j) * (e(idx1,i,j) - e(idx2,i,j))
      END DO
      ELSE
      ! Reverse compression interpolation (moving toward tension)
      e_int1 = stranCurrent - e(curr_ID,i,j)
      e_int2 = e(curr_ID+n-1,i,j) - stranNext

      force(i) = force(i) - STIF(curr_ID,i,j) * e_int1
      force(i) = force(i) - STIF(curr_ID+n,i,j) * e_int2

      DO k = 2, n
      idx1 = curr_ID + k - 1
      idx2 = curr_ID + k - 2
      force(i) = force(i) - STIF(idx1,i,j) * (e(idx2,i,j) - e(idx1,i,j))
      END DO
      END IF
      END IF
C ----------------------------------------------------------------------
      end do
      statev(istatev+i)=force(i)
      end do
999   continue
      deallocate(A11, A12, A21, A22, A33,
     + B11, B12, B21, B22, B33,
     + C11, C12, C21, C22, C33,
     + D11, D12, D21, D22, D33,
     + e1, e2, STIF, e)
      return
      end